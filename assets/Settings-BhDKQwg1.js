import{r as e,j as s,a5 as a,L as t,G as r,U as l,_ as i,a6 as c,a7 as n,a8 as o,a9 as d,E as m}from"./react-core-Ds-4081u.js";import{B as x}from"./button-0HSBgZKY.js";import{I as u}from"./input-ZFdxA9mo.js";import{L as p}from"./label-CCxDttXb.js";import{S as h}from"./switch-Ilq1dr1T.js";import{c as j,u as f}from"./index-CoeHQGik.js";import{u as g}from"./useAuth-PoIe4DG1.js";import{s as N}from"./client-CroYBHHp.js";import{A as b,h as v,a as w,b as y,c as S,d as k,e as _,f as C,g as E}from"./alert-dialog-ZEKvnTxk.js";import{u as I}from"./useSEO-6HQknDN3.js";import{b as z}from"./react-router-BmNS8iat.js";import"./react-dom-CJlssZTM.js";import"./vendor-BS0l4q4C.js";import"./radix-ui-ByoYm48K.js";import"./tanstack-DamGjQ03.js";import"./markdown-01_NS6zS.js";import"./utils-Bmne0XXo.js";import"./supabase-CqVAhX3r.js";const q=e.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...l},i)=>s.jsx(a,{ref:i,decorative:r,orientation:t,className:j("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...l}));q.displayName=a.displayName;const A="nabd_show_ratings",F="nabd_animations";function L(e,s=!0){try{const a=localStorage.getItem(e);return null===a?s:"false"!==a}catch{return s}}const M=()=>{I({title:"الإعدادات",description:"إدارة إعدادات حسابك وتفضيلاتك الشخصية في نبض",noIndex:!0});const a=z(),{user:j,signOut:M,loading:O}=g(),{toast:R}=f(),[B,G]=e.useState(""),[H,U]=e.useState(!1),[D,J]=e.useState(!1),[K,P]=e.useState(!0),[Q,T]=e.useState(!0),V=e.useRef("");e.useEffect(()=>{P(L(A,!0)),T(L(F,!0))},[]),e.useEffect(()=>{O||j||a("/auth",{replace:!0})},[j,O,a]),e.useEffect(()=>{(async()=>{if(!j)return;const e=j.user_metadata?.display_name??j.user_metadata?.full_name??"";e&&!B&&(G(String(e)),V.current=String(e)),U(!0);try{const{data:s,error:a}=await N.from("profiles").select("display_name").eq("id",j.id).maybeSingle();if(a)throw a;const t=(s?.display_name||e||"").toString();G(t),V.current=t}catch(s){}finally{U(!1)}})()},[j?.id]);const W=e.useMemo(()=>{if(!j)return!1;const e=B.trim();return e.length>0&&e!==V.current.trim()},[B,j]);return O||H?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:s.jsx(t,{className:"h-12 w-12 animate-spin text-neon-purple"})}):j?s.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",dir:"rtl",children:[s.jsx("div",{className:"fixed top-0 left-1/4 w-72 sm:w-96 h-72 sm:h-96 bg-neon-purple/20 rounded-full blur-[120px] -z-10"}),s.jsx("div",{className:"fixed bottom-0 right-1/4 w-72 sm:w-96 h-72 sm:h-96 bg-neon-blue/20 rounded-full blur-[120px] -z-10"}),s.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/50",children:s.jsx("div",{className:"mx-auto w-full max-w-3xl px-4 py-4",children:s.jsxs(x,{onClick:()=>a("/",{replace:!0}),variant:"ghost",className:"gap-2 text-muted-foreground hover:text-foreground",children:[s.jsx(r,{className:"h-5 w-5"}),"العودة للرئيسية"]})})}),s.jsxs("main",{className:"mx-auto w-full max-w-3xl px-4 py-8 sm:py-12 space-y-8",children:[s.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-foreground",children:"الإعدادات"}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(l,{className:"h-6 w-6 text-neon-purple"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الملف الشخصي"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"email",className:"text-muted-foreground",children:"البريد الإلكتروني"}),s.jsxs("div",{className:"relative",children:[s.jsx(i,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(u,{id:"email",type:"email",value:j.email||"",disabled:!0,className:"pr-10 bg-muted/30 border-border/50 text-muted-foreground cursor-not-allowed"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"displayName",children:"اسم العرض"}),s.jsxs("div",{className:"relative",children:[s.jsx(l,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(u,{id:"displayName",type:"text",inputMode:"text",placeholder:"اسمك الذي يظهر للآخرين",value:B,onChange:e=>G(e.target.value),className:"pr-10 bg-muted/50 border-border/50"})]})]}),s.jsxs(x,{onClick:async()=>{if(!j)return;const e=B.trim();if(0!==e.length){J(!0);try{const{error:s}=await N.from("profiles").update({display_name:e}).eq("id",j.id);if(s)throw s;V.current=e,R({title:"تم الحفظ",description:"تم تحديث معلومات الملف الشخصي"})}catch(s){R({title:"خطأ",description:"حدث خطأ أثناء حفظ البيانات",variant:"destructive"})}finally{J(!1)}}else R({title:"اسم غير صالح",description:"يرجى إدخال اسم عرض صحيح",variant:"destructive"})},disabled:D||!W,className:"w-full sm:w-auto bg-gradient-to-r from-neon-purple to-neon-blue hover:opacity-90 gap-2",children:[D?s.jsx(t,{className:"h-4 w-4 animate-spin"}):s.jsx(c,{className:"h-4 w-4"}),"حفظ التغييرات"]})]})]}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(n,{className:"h-6 w-6 text-neon-purple"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"تفضيلات العرض"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3 py-3",children:[s.jsxs("div",{className:"space-y-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-foreground",children:"عرض التقييمات"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"إظهار تقييمات الأدوات في البطاقات"})]}),s.jsx(h,{checked:K,onCheckedChange:e=>{P(e);try{localStorage.setItem(A,String(e))}catch{}R({title:e?"تم تفعيل التقييمات":"تم إخفاء التقييمات",description:e?"ستظهر التقييمات في البطاقات":"تم إخفاء التقييمات من البطاقات"})}})]}),s.jsx(q,{className:"bg-border/50"}),s.jsxs("div",{className:"flex items-center justify-between gap-3 py-3",children:[s.jsxs("div",{className:"space-y-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-foreground",children:"الحركات والتأثيرات"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"تفعيل حركات الواجهة والانتقالات"})]}),s.jsx(h,{checked:Q,onCheckedChange:e=>{T(e);try{localStorage.setItem(F,String(e))}catch{}R({title:e?"تم تفعيل الحركات":"تم إيقاف الحركات",description:e?"ستظهر الحركات في الواجهة":"تم إيقاف حركات الواجهة"})}})]})]})]}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(o,{className:"h-6 w-6 text-neon-purple"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الإشعارات"})]}),s.jsx("p",{className:"text-muted-foreground",children:"إشعارات التطبيق غير متوفرة حالياً. سيتم إضافتها في تحديث قادم."})]}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(d,{className:"h-6 w-6 text-destructive"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الحساب"})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs(x,{onClick:async()=>{await M(),R({title:"تم تسجيل الخروج",description:"نراك قريباً!"}),a("/",{replace:!0})},variant:"outline",className:"w-full sm:w-auto gap-2 border-border/50",children:[s.jsx(d,{className:"h-4 w-4"}),"تسجيل الخروج"]}),s.jsxs(b,{children:[s.jsx(v,{asChild:!0,children:s.jsxs(x,{variant:"outline",className:"w-full sm:w-auto gap-2 border-destructive/50 text-destructive hover:bg-destructive/10",children:[s.jsx(m,{className:"h-4 w-4"}),"حذف الحساب"]})}),s.jsxs(w,{dir:"rtl",className:"glass",children:[s.jsxs(y,{children:[s.jsx(S,{children:"هل أنت متأكد من حذف الحساب؟"}),s.jsx(k,{children:"سيتم حذف حسابك نهائياً مع جميع المراجعات والبيانات المرتبطة به. هذا الإجراء لا يمكن التراجع عنه."})]}),s.jsxs(_,{className:"flex-row-reverse gap-2",children:[s.jsx(C,{className:"mt-0",children:"إلغاء"}),s.jsx(E,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>{R({title:"غير متوفر حالياً",description:"يرجى التواصل مع الدعم لحذف حسابك",variant:"destructive"})},children:"حذف الحساب"})]})]})]})]})]})]})]}):null};export{M as default};
