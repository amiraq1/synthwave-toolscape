import{ai as e,r as s,j as a,aj as l,ak as r,al as i,G as t,L as n,a4 as c,am as d,O as o,an as m,ao as x,ap as u,E as h,aq as j,ar as p,Y as g,as as f,at as v}from"./react-vendor-DJsICmPt.js";import{B as N}from"./button-B7vBikIo.js";import{c as b,u as y}from"./index-AG0bShzI.js";import{u as w}from"./useAdminCheck-Cyv4UjeL.js";import{I as _}from"./input-DsQiG2qT.js";import{T as k}from"./textarea-Cb-6qKig.js";import{B as C}from"./badge-BHsni5c_.js";import{T as S,a as z,b as R,c as q,d as E,e as O}from"./table-CqEdhr5I.js";import{D as A,a as $,b as B,c as D,d as I}from"./dialog-D-cbJgg4.js";import{A as L,a as Q,b as T,c as V,d as K,e as F,f as G,g as Y}from"./alert-dialog-CTcqkS1q.js";import{S as H,a as J,b as M,c as P,d as U}from"./select-BLxQO0-j.js";import{u as W}from"./useTools-CIm32-0Q.js";import{s as X}from"./client-Dp-bvcZ2.js";import{u as Z}from"./useAuth-DYZ77wHP.js";import{u as ee}from"./useSEO-BkuxEvtU.js";import"./vendor-Duk2WWTq.js";import"./ui-vendor-BpqZfnrR.js";import"./supabase-vendor-CtVNLq9t.js";const se=e,ae=s.forwardRef(({className:e,...s},r)=>a.jsx(l,{ref:r,className:b("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));ae.displayName=l.displayName;const le=s.forwardRef(({className:e,...s},l)=>a.jsx(r,{ref:l,className:b("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...s}));le.displayName=r.displayName;const re=s.forwardRef(({className:e,...s},l)=>a.jsx(i,{ref:l,className:b("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));re.displayName=i.displayName;const ie=["Ù†ØµÙˆØµ","ØµÙˆØ±","ÙÙŠØ¯ÙŠÙˆ","Ø¨Ø±Ù…Ø¬Ø©","Ø¥Ù†ØªØ§Ø¬ÙŠØ©","Ø¯Ø±Ø§Ø³Ø© ÙˆØ·Ù„Ø§Ø¨"],te=["Ù…Ø¬Ø§Ù†ÙŠ","Ù…Ø¯ÙÙˆØ¹","Ù…Ø¬Ø§Ù†ÙŠ Ø¬Ø²Ø¦ÙŠØ§Ù‹"],ne=()=>{const{data:e,isLoading:l}=W("","Ø§Ù„ÙƒÙ„"),{toast:r}=y(),i=t(),m=(null==e?void 0:e.pages.flat())??[],[x,u]=s.useState(null),[h,j]=s.useState(null),[p,g]=s.useState(!1),[f,v]=s.useState(!1),[b,w]=s.useState({title:"",description:"",url:"",category:"",pricing_type:"",image_url:""});return l?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(n,{className:"h-8 w-8 animate-spin text-neon-purple"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-xl font-bold",children:["Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª (",m.length,")"]})}),a.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:a.jsxs(S,{children:[a.jsx(z,{children:a.jsxs(R,{className:"bg-muted/50",children:[a.jsx(q,{className:"text-right",children:"Ø§Ù„Ø£Ø¯Ø§Ø©"}),a.jsx(q,{className:"text-right",children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),a.jsx(q,{className:"text-right",children:"Ø§Ù„Ø³Ø¹Ø±"}),a.jsx(q,{className:"text-right",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),a.jsx(E,{children:m.map(e=>a.jsxs(R,{children:[a.jsx(O,{children:a.jsxs("div",{className:"flex items-center gap-3",children:[e.image_url?a.jsx("img",{src:e.image_url,alt:e.title,width:40,height:40,loading:"lazy",decoding:"async",className:"w-10 h-10 rounded-lg object-contain bg-white p-1"}):a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-neon-purple to-neon-blue flex items-center justify-center text-lg",children:"ðŸ¤–"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:e.title}),a.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 max-w-[200px]",children:e.description})]})]})}),a.jsx(O,{children:a.jsx(C,{variant:"secondary",className:"bg-neon-purple/20 text-neon-purple",children:e.category})}),a.jsx(O,{children:a.jsx(C,{variant:"secondary",className:"Ù…Ø¬Ø§Ù†ÙŠ"===e.pricing_type?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400",children:e.pricing_type})}),a.jsx(O,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{size:"sm",variant:"ghost",onClick:()=>window.open(e.url,"_blank"),children:a.jsx(c,{className:"h-4 w-4"})}),a.jsx(N,{size:"sm",variant:"ghost",onClick:()=>(e=>{u(e),w({title:e.title,description:e.description,url:e.url,category:e.category,pricing_type:e.pricing_type,image_url:e.image_url||""})})(e),children:a.jsx(d,{className:"h-4 w-4"})}),a.jsx(N,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>j(e),children:a.jsx(o,{className:"h-4 w-4"})})]})})]},e.id))})]})}),a.jsx(A,{open:!!x,onOpenChange:()=>u(null),children:a.jsxs($,{className:"max-w-lg",dir:"rtl",children:[a.jsx(B,{children:a.jsx(D,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø©"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©"}),a.jsx(_,{value:b.title,onChange:e=>w({...b,title:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ÙˆØµÙ"}),a.jsx(k,{value:b.description,onChange:e=>w({...b,description:e.target.value}),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø±Ø§Ø¨Ø·"}),a.jsx(_,{value:b.url,onChange:e=>w({...b,url:e.target.value}),dir:"ltr"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),a.jsxs(H,{value:b.category,onValueChange:e=>w({...b,category:e}),children:[a.jsx(J,{children:a.jsx(M,{})}),a.jsx(P,{children:ie.map(e=>a.jsx(U,{value:e,children:e},e))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ù†ÙˆØ¹ Ø§Ù„ØªØ³Ø¹ÙŠØ±"}),a.jsxs(H,{value:b.pricing_type,onValueChange:e=>w({...b,pricing_type:e}),children:[a.jsx(J,{children:a.jsx(M,{})}),a.jsx(P,{children:te.map(e=>a.jsx(U,{value:e,children:e},e))})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),a.jsx(_,{value:b.image_url,onChange:e=>w({...b,image_url:e.target.value}),dir:"ltr",placeholder:"https://..."})]})]}),a.jsxs(I,{children:[a.jsx(N,{variant:"outline",onClick:()=>u(null),children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsxs(N,{onClick:async()=>{if(x){g(!0);try{const{error:e}=await X.from("tools").update({title:b.title,description:b.description,url:b.url,category:b.category,pricing_type:b.pricing_type,image_url:b.image_url||null}).eq("id",x.id);if(e)throw e;r({title:"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«",description:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­"}),i.invalidateQueries({queryKey:["tools"]}),u(null)}catch(e){r({title:"Ø®Ø·Ø£",description:e.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ø§Ø©",variant:"destructive"})}finally{g(!1)}}},disabled:p,children:[p&&a.jsx(n,{className:"h-4 w-4 animate-spin ml-2"}),"Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª"]})]})]})}),a.jsx(L,{open:!!h,onOpenChange:()=>j(null),children:a.jsxs(Q,{dir:"rtl",children:[a.jsxs(T,{children:[a.jsx(V,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ"}),a.jsxs(K,{children:['Ø³ÙŠØªÙ… Ø­Ø°Ù "',null==h?void 0:h.title,'" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.']})]}),a.jsxs(F,{className:"flex-row-reverse gap-2",children:[a.jsx(G,{children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsxs(Y,{onClick:async()=>{if(h){v(!0);try{const{error:e}=await X.from("tools").delete().eq("id",h.id);if(e)throw e;r({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­"}),i.invalidateQueries({queryKey:["tools"]}),j(null)}catch(e){r({title:"Ø®Ø·Ø£",description:e.message||"ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø©",variant:"destructive"})}finally{v(!1)}}},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:f,children:[f&&a.jsx(n,{className:"h-4 w-4 animate-spin ml-2"}),"Ø­Ø°Ù"]})]})]})})]})},ce=()=>{const{user:e}=Z(),{toast:l}=y(),[r,i]=s.useState([]),[t,c]=s.useState(!0),[d,o]=s.useState(null),[h,j]=s.useState(!1),p=async()=>{c(!0);try{const{data:e,error:s}=await X.rpc("admin_get_users");if(s)throw s;const a=(e||[]).map(e=>({id:e.user_id,email:e.email||null,display_name:e.display_name,created_at:e.created_at,role:e.role||null}));i(a)}catch(e){l({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",variant:"destructive"})}finally{c(!1)}};s.useEffect(()=>{p()},[]);const g=e=>{switch(e){case"admin":return a.jsxs(C,{className:"bg-red-500/20 text-red-400 border-red-500/30",children:[a.jsx(m,{className:"h-3 w-3 ml-1"}),"Ù…Ø¯ÙŠØ±"]});case"moderator":return a.jsxs(C,{className:"bg-amber-500/20 text-amber-400 border-amber-500/30",children:[a.jsx(x,{className:"h-3 w-3 ml-1"}),"Ù…Ø´Ø±Ù"]});default:return a.jsx(C,{variant:"secondary",className:"bg-muted text-muted-foreground",children:"Ù…Ø³ØªØ®Ø¯Ù…"})}};return t?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(n,{className:"h-8 w-8 animate-spin text-neon-purple"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-xl font-bold",children:["Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (",r.length,")"]})}),a.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:a.jsxs(S,{children:[a.jsx(z,{children:a.jsxs(R,{className:"bg-muted/50",children:[a.jsx(q,{className:"text-right",children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),a.jsx(q,{className:"text-right",children:"Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©"}),a.jsx(q,{className:"text-right",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„"}),a.jsx(q,{className:"text-right",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),a.jsx(E,{children:r.map(s=>a.jsxs(R,{children:[a.jsx(O,{children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:s.display_name||"Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]})}),a.jsx(O,{children:g(s.role)}),a.jsx(O,{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleDateString("ar-IQ")}),a.jsx(O,{children:s.id!==(null==e?void 0:e.id)?a.jsxs("div",{className:"flex items-center gap-1",children:["admin"!==s.role&&a.jsx(N,{size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-400 hover:bg-red-500/10",onClick:()=>o({user:s,newRole:"admin"}),children:a.jsx(m,{className:"h-4 w-4"})}),"moderator"!==s.role&&a.jsx(N,{size:"sm",variant:"ghost",className:"text-amber-400 hover:text-amber-400 hover:bg-amber-500/10",onClick:()=>o({user:s,newRole:"moderator"}),children:a.jsx(x,{className:"h-4 w-4"})}),s.role&&a.jsx(N,{size:"sm",variant:"ghost",className:"text-muted-foreground hover:text-foreground",onClick:()=>o({user:s,newRole:null}),children:a.jsx(u,{className:"h-4 w-4"})})]}):a.jsx(C,{variant:"outline",className:"text-xs",children:"Ø£Ù†Øª"})})]},s.id))})]})}),a.jsx(L,{open:!!d,onOpenChange:()=>o(null),children:a.jsxs(Q,{dir:"rtl",children:[a.jsxs(T,{children:[a.jsx(V,{children:"ØªØºÙŠÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª"}),a.jsx(K,{children:null===(null==d?void 0:d.newRole)?`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ù† "${(null==d?void 0:d.user.display_name)||(null==d?void 0:d.user.email)}"ØŸ`:`Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ù†Ø­ "${(null==d?void 0:d.user.display_name)||(null==d?void 0:d.user.email)}" ØµÙ„Ø§Ø­ÙŠØ© ${"admin"===(null==d?void 0:d.newRole)?"Ø§Ù„Ù…Ø¯ÙŠØ±":"Ø§Ù„Ù…Ø´Ø±Ù"}ØŸ`})]}),a.jsxs(F,{className:"flex-row-reverse gap-2",children:[a.jsx(G,{children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsxs(Y,{onClick:async()=>{if(!d)return;const{user:e,newRole:s}=d;j(!0);try{if(null===s){const{error:s}=await X.from("user_roles").delete().eq("user_id",e.id);if(s)throw s}else if(null===e.role){const{error:a}=await X.from("user_roles").insert({user_id:e.id,role:s});if(a)throw a}else{const{error:a}=await X.from("user_roles").update({role:s}).eq("user_id",e.id);if(a)throw a}l({title:"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«",description:`ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙ„Ø§Ø­ÙŠØ§Øª ${e.display_name||e.email}`}),p()}catch(a){l({title:"Ø®Ø·Ø£",description:a.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª",variant:"destructive"})}finally{j(!1),o(null)}},disabled:h,children:[h&&a.jsx(n,{className:"h-4 w-4 animate-spin ml-2"}),"ØªØ£ÙƒÙŠØ¯"]})]})]})})]})},de=()=>{ee({title:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",description:"Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",noIndex:!0});const e=h(),{isAdmin:l,loading:r}=w();return s.useEffect(()=>{r||l||e("/")},[l,r,e]),r?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(n,{className:"h-12 w-12 animate-spin text-neon-purple mx-auto"}),a.jsx("p",{className:"text-muted-foreground",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª..."})]})}):l?a.jsxs("div",{className:"min-h-screen bg-background",dir:"rtl",children:[a.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/50",children:a.jsx("div",{className:"container mx-auto max-w-7xl px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(p,{className:"h-6 w-6 text-neon-purple"}),a.jsx("h1",{className:"text-xl font-bold",children:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"})]}),a.jsxs(N,{variant:"ghost",onClick:()=>e("/"),className:"gap-2",children:[a.jsx(g,{className:"h-5 w-5"}),"Ø§Ù„Ø¹ÙˆØ¯Ø©"]})]})})}),a.jsx("main",{className:"container mx-auto max-w-7xl px-4 py-8",children:a.jsxs(se,{defaultValue:"tools",className:"space-y-6",children:[a.jsxs(ae,{className:"grid w-full max-w-md grid-cols-2 mx-auto",children:[a.jsxs(le,{value:"tools",className:"gap-2",children:[a.jsx(f,{className:"h-4 w-4"}),"Ø§Ù„Ø£Ø¯ÙˆØ§Øª"]}),a.jsxs(le,{value:"users",className:"gap-2",children:[a.jsx(v,{className:"h-4 w-4"}),"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"]})]}),a.jsx(re,{value:"tools",className:"glass rounded-xl p-6",children:a.jsx(ne,{})}),a.jsx(re,{value:"users",className:"glass rounded-xl p-6",children:a.jsx(ce,{})})]})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(j,{className:"h-16 w-16 text-destructive mx-auto"}),a.jsx("h1",{className:"text-2xl font-bold",children:"ØºÙŠØ± Ù…ØµØ±Ø­"}),a.jsx("p",{className:"text-muted-foreground",children:"Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©"}),a.jsx(N,{onClick:()=>e("/"),children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})})};export{de as default};
