import{r as e,j as s,B as r,S as t,k as a,X as l,U as o,M as n,L as i,l as d,m as c}from"./react-core-Ds-4081u.js";import{s as m}from"./client-CroYBHHp.js";import{B as h}from"./button-z3iXzSpy.js";import{I as x}from"./input-DRGlYIJe.js";import{c as u}from"./index-BjbHwrV-.js";import"./react-dom-CJlssZTM.js";import"./vendor-BS0l4q4C.js";import"./radix-ui-ByoYm48K.js";import"./tanstack-DamGjQ03.js";import"./markdown-01_NS6zS.js";import"./supabase-CqVAhX3r.js";import"./utils-Bmne0XXo.js";import"./react-router-BmNS8iat.js";const p=()=>{const[p,b]=e.useState(!1),[w,f]=e.useState(""),{messages:j,sendMessage:g,isLoading:N,clearChat:v,error:y}=(()=>{const[s,r]=e.useState([]),[t,a]=e.useState(!1),[l,o]=e.useState(null);return{messages:s,sendMessage:async e=>{try{a(!0),o(null);const t=[...s,{role:"user",content:e}];r(t);const l=s.slice(-5).map(e=>({role:e.role,parts:e.content})),{data:n,error:i}=await m.functions.invoke("chat",{body:{query:e,history:l}});if(i)throw i;const d=n;return r(e=>[...e,{role:"model",content:d.answer}]),d}catch(t){let e="Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©";return 401===t?.context?.status||t?.message?.includes("401")||t?.message?.includes("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„")?e="ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø¨Ø¶ AI":t?.message&&(e=t.message),o(e),null}finally{a(!1)}},clearChat:()=>{r([]),o(null)},isLoading:t,error:l}})(),k=e.useRef(null);e.useEffect(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[j,N,p]);const C=async e=>{if(e?.preventDefault(),!w.trim()||N)return;const s=w;f(""),await g(s)};return s.jsxs("div",{className:"fixed bottom-4 left-4 z-50 flex flex-col items-start gap-2",dir:"rtl",children:[p&&s.jsxs("div",{className:"w-[350px] sm:w-[400px] h-[500px] max-h-[80vh] bg-background/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl flex flex-col overflow-hidden animate-in slide-in-from-bottom-5 fade-in duration-300",children:[s.jsxs("div",{className:"p-4 border-b border-white/10 bg-gradient-to-r from-neon-purple/20 to-blue-600/20 flex items-center justify-between shrink-0",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-neon-purple to-blue-500 flex items-center justify-center shadow-lg border border-white/20",children:s.jsx(r,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:["Ù†Ø¨Ø¶ AI",s.jsx(t,{className:"w-3 h-3 text-yellow-400 animate-pulse"})]}),s.jsxs("p",{className:"text-[10px] text-white/70 flex items-center gap-1",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ (Ù…ØªØµÙ„)"]})]})]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/70 hover:text-white hover:bg-white/10",onClick:v,title:"Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©",children:s.jsx(a,{className:"w-4 h-4"})}),s.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/70 hover:text-white hover:bg-white/10",onClick:()=>b(!1),children:s.jsx(l,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar bg-black/20",ref:k,children:[0===j.length&&s.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 opacity-70 mt-10",children:[s.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center",children:s.jsx(t,{className:"w-8 h-8 text-neon-purple"})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-medium text-white",children:"Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! ðŸ‘‹"}),s.jsx("p",{className:"text-xs text-muted-foreground max-w-[200px]",children:"Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ. Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø£ÙŠ Ø´ÙŠØ¡!"})]}),s.jsx("div",{className:"flex flex-wrap justify-center gap-2 mt-4 max-w-[280px]",children:["Ø£Ø¯ÙˆØ§Øª Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©","Ù…Ø³Ø§Ø¹Ø¯ Ù„Ù„ÙƒØªØ§Ø¨Ø© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©","Ø£ÙØ¶Ù„ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©"].map(e=>s.jsx("button",{onClick:()=>{f(e),C()},className:"text-[10px] bg-white/5 hover:bg-white/10 border border-white/10 rounded-full px-3 py-1.5 transition-colors",children:e},e))})]}),j.map((e,t)=>s.jsxs("div",{className:u("flex gap-3 max-w-[90%]","user"===e.role?"mr-auto flex-row-reverse":"ml-auto"),children:[s.jsx("div",{className:u("w-8 h-8 rounded-full flex items-center justify-center shrink-0 border mt-1","user"===e.role?"bg-white/10 border-white/20":"bg-gradient-to-br from-neon-purple to-blue-600 border-white/20 shadow-lg"),children:"user"===e.role?s.jsx(o,{className:"w-4 h-4"}):s.jsx(r,{className:"w-4 h-4 text-white"})}),s.jsx("div",{className:u("rounded-2xl px-4 py-2.5 text-sm shadow-sm","user"===e.role?"bg-white/10 text-white rounded-tl-none border border-white/10":"bg-card/80 text-foreground rounded-tr-none border border-white/5 backdrop-blur-sm"),children:"user"===e.role?e.content:s.jsx("div",{className:"prose prose-invert prose-p:text-sm prose-a:text-neon-purple prose-a:no-underline hover:prose-a:underline prose-ul:my-1 prose-li:my-0.5 max-w-none",children:s.jsx(n,{children:e.content})})})]},t)),N&&s.jsxs("div",{className:"flex gap-3 ml-auto max-w-[80%]",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-neon-purple to-blue-600 flex items-center justify-center shrink-0 border border-white/20 shadow-lg mt-1",children:s.jsx(r,{className:"w-4 h-4 text-white animate-pulse"})}),s.jsxs("div",{className:"bg-card/40 rounded-2xl rounded-tr-none px-4 py-3 flex items-center gap-1.5 border border-white/5",children:[s.jsx("span",{className:"w-2 h-2 bg-white/40 rounded-full animate-bounce [animation-delay:-0.3s]"}),s.jsx("span",{className:"w-2 h-2 bg-white/40 rounded-full animate-bounce [animation-delay:-0.15s]"}),s.jsx("span",{className:"w-2 h-2 bg-white/40 rounded-full animate-bounce"})]})]}),y&&!N&&s.jsxs("div",{className:"flex gap-3 ml-auto max-w-[90%]",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500/20 flex items-center justify-center shrink-0 border border-red-500/30 mt-1",children:s.jsx(r,{className:"w-4 h-4 text-red-400"})}),s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-2xl rounded-tr-none px-4 py-2.5 text-sm",children:[s.jsx("p",{className:"text-red-400 font-medium mb-1",children:"âš ï¸ Ø®Ø·Ø£"}),s.jsx("p",{className:"text-red-300/80 text-xs",children:y}),y.includes("ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„")&&s.jsx("a",{href:"/auth",className:"inline-block mt-2 text-xs bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full transition-colors",children:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ â†’"})]})]})]}),s.jsxs("form",{onSubmit:C,className:"p-3 bg-background border-t border-white/10 shrink-0 flex gap-2",children:[s.jsx(x,{value:w,onChange:e=>f(e.target.value),placeholder:"Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...",className:"flex-1 bg-white/5 border-white/10 focus-visible:ring-neon-purple/50 min-h-[44px]",disabled:N}),s.jsx(h,{type:"submit",size:"icon",disabled:N||!w.trim(),className:u("h-11 w-11 shrink-0 transition-all",w.trim()?"bg-gradient-to-br from-neon-purple to-blue-600 shadow-lg shadow-neon-purple/20 hover:scale-105":"bg-white/5 text-white/30"),children:N?s.jsx(i,{className:"w-5 h-5 animate-spin"}):s.jsx(d,{className:"w-5 h-5 ml-0.5"})})]})]}),s.jsx(h,{onClick:()=>b(!p),className:u("h-14 w-14 rounded-full shadow-2xl transition-all duration-300 hover:scale-110",p?"bg-background border border-white/10 text-white hover:bg-white/10 rotate-90":"bg-gradient-to-r from-neon-purple to-blue-600 border border-white/20 animate-pulse-gentle"),children:p?s.jsx(l,{className:"w-6 h-6"}):s.jsx(c,{className:"w-7 h-7 text-white"})})]})};export{p as default};
