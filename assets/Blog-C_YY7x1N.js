import{G as e,r as s,aB as t,I as r,j as a,L as l,aC as n,z as i,aD as o,aE as c,am as d,O as m,aF as x,aG as u,af as p}from"./react-vendor-DJsICmPt.js";import{s as h}from"./client-Dp-bvcZ2.js";import{B as g}from"./button-B7vBikIo.js";import{B as j}from"./badge-BHsni5c_.js";import{A as f,a as b,b as N,c as v,d as w,e as y,f as _,g as k}from"./alert-dialog-CTcqkS1q.js";import{N as C,F as S}from"./Footer-DRUBi8Sg.js";import{a7 as z,a5 as E,a8 as P,a6 as q,a9 as F,a3 as A,a4 as D}from"./vendor-Duk2WWTq.js";import{u as O}from"./index-AG0bShzI.js";import{u as U}from"./useAuth-DYZ77wHP.js";import{D as V,a as L,b as T,c as B,e as G,d as I}from"./dialog-D-cbJgg4.js";import{F as K,a as $,b as Q,c as R,d as H,e as J,f as M}from"./form-BdXSofIZ.js";import{I as W}from"./input-DsQiG2qT.js";import{T as X}from"./textarea-Cb-6qKig.js";import{S as Y}from"./switch-BI7PL0F7.js";import{u as Z}from"./useAdminCheck-Cyv4UjeL.js";import"./supabase-vendor-CtVNLq9t.js";import"./ui-vendor-BpqZfnrR.js";import"./label-DafZ5mgr.js";const ee=E({title:q().min(3,"Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹").max(200),slug:q().optional(),content:q().min(20,"Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹"),excerpt:q().max(300,"Ø§Ù„Ù…Ù„Ø®Øµ Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹").optional(),image_url:q().url("Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­").optional().or(F("")),is_published:P()}),se=e=>e.toLowerCase().replace(/[^\u0621-\u064Aa-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),te=({open:i,onOpenChange:o,postToEdit:c})=>{const{toast:d}=O(),{user:m}=U(),x=e(),[u,p]=s.useState(""),[j,f]=s.useState(!1),[b,N]=s.useState(!1),v=!!c,w=t({resolver:z(ee),defaultValues:{title:"",slug:"",content:"",excerpt:"",image_url:"",is_published:!0}}),y=w.watch("title");s.useEffect(()=>{v||!y||w.getValues("slug")||se(y)},[y,v,w]),s.useEffect(()=>{i&&c?(w.reset({title:c.title,slug:c.slug||"",content:c.content,excerpt:c.excerpt||"",image_url:c.image_url||"",is_published:c.is_published}),p(c.image_url||"")):i&&(w.reset({title:"",slug:"",content:"",excerpt:"",image_url:"",is_published:!0}),p(""))},[i,c,w]);const _=w.watch("image_url");s.useEffect(()=>{_?(p(_),f(!1)):p("")},[_]);const k=r({mutationFn:async e=>{const s=e.slug||se(e.title)+"-"+Date.now().toString(36);if(v&&c){const{error:t}=await h.from("posts").update({title:e.title,slug:s,content:e.content,excerpt:e.excerpt||null,image_url:e.image_url||null,is_published:e.is_published}).eq("id",c.id);if(t)throw t}else{const{error:t}=await h.from("posts").insert([{title:e.title,slug:s,content:e.content,excerpt:e.excerpt||null,image_url:e.image_url||null,is_published:e.is_published,author_id:null==m?void 0:m.id}]);if(t)throw t}},onSuccess:()=>{d({title:v?"âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«":"ğŸ‰ ØªÙ… Ø§Ù„Ù†Ø´Ø±",className:"bg-emerald-500/10 text-emerald-500"}),x.invalidateQueries({queryKey:["posts"]}),o(!1),w.reset()},onError:e=>{d({title:"Ø®Ø·Ø£",description:(null==e?void 0:e.message)||(v?"ÙØ´Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«":"ÙØ´Ù„ Ø§Ù„Ù†Ø´Ø±"),variant:"destructive"})}}),C=()=>{const e=w.getValues("title");e&&w.setValue("slug",se(e))};return a.jsx(V,{open:i,onOpenChange:o,children:a.jsxs(L,{className:"sm:max-w-2xl w-[95vw] max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden border-white/10 bg-background/95 backdrop-blur-xl",dir:"rtl",children:[a.jsxs(T,{className:"p-4 pb-2 border-b border-white/5 bg-muted/20 shrink-0",children:[a.jsx(B,{className:"text-lg font-bold",children:v?"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„":"Ø¥Ø¶Ø§ÙØ© Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯"}),a.jsx(G,{className:"text-xs",children:v?"Ù‚Ù… Ø¨ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚Ø§Ù„":"Ø´Ø§Ø±Ùƒ Ù…Ø¹Ø±ÙØªÙƒ Ù…Ø¹ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹"})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:a.jsx(K,{...w,children:a.jsxs("form",{id:"post-form",onSubmit:w.handleSubmit(e=>k.mutate(e)),className:"space-y-4 pb-4",children:[a.jsx($,{control:w.control,name:"title",render:({field:e})=>a.jsxs(Q,{children:[a.jsx(R,{className:"text-xs",children:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„ *"}),a.jsx(H,{children:a.jsx(W,{placeholder:"Ø¹Ù†ÙˆØ§Ù† Ø¬Ø°Ø§Ø¨ Ù„Ù„Ù…Ù‚Ø§Ù„...",...e,className:"h-10 bg-background/50"})}),a.jsx(J,{className:"text-[10px]"})]})}),a.jsx($,{control:w.control,name:"slug",render:({field:e})=>a.jsxs(Q,{children:[a.jsxs(R,{className:"text-xs flex items-center justify-between",children:[a.jsx("span",{children:"Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ØªØµØ± (Slug)"}),a.jsx(g,{type:"button",variant:"ghost",size:"sm",onClick:C,className:"h-6 text-xs text-neon-purple",children:"ØªÙˆÙ„ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ"})]}),a.jsx(H,{children:a.jsx(W,{placeholder:"my-post-title",dir:"ltr",...e,className:"h-8 bg-background/50 font-mono text-sm"})}),a.jsx(M,{className:"text-[10px]",children:"ÙŠÙØ³ØªØ®Ø¯Ù… ÙÙŠ Ø±Ø§Ø¨Ø· URL. Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ."})]})}),a.jsxs("div",{className:"space-y-4 border border-white/5 bg-muted/10 p-4 rounded-xl",children:[a.jsxs(Q,{children:[a.jsx(R,{className:"text-xs",children:"Ø±ÙØ¹ ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Ø²"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(W,{type:"file",accept:"image/*",className:"bg-background/50 text-xs h-9 cursor-pointer file:text-foreground",onChange:async e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];if(t)try{N(!0);const e=t.name.split(".").pop(),s=`${`${crypto.randomUUID()}.${e}`}`,{error:r}=await h.storage.from("blog_images").upload(s,t);if(r)throw r;const{data:{publicUrl:a}}=h.storage.from("blog_images").getPublicUrl(s);w.setValue("image_url",a),p(a),f(!1),d({title:"ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­",className:"bg-emerald-500/10 text-emerald-500"})}catch(r){d({title:"ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹",description:r.message,variant:"destructive"})}finally{N(!1),e.target.value=""}},disabled:b}),b&&a.jsx("div",{className:"flex items-center justify-center px-3 border border-white/10 rounded-md bg-muted/20",children:a.jsx(l,{className:"h-4 w-4 animate-spin text-neon-purple"})})]})]}),a.jsx($,{control:w.control,name:"image_url",render:({field:e})=>a.jsxs(Q,{children:[a.jsxs(R,{className:"text-xs flex items-center gap-1",children:[a.jsx(n,{className:"w-3 h-3"})," ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù"]}),a.jsx(H,{children:a.jsx(W,{placeholder:"https://...",dir:"ltr",...e,className:"h-8 bg-background/50"})}),a.jsx(J,{className:"text-[10px]"}),a.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-white/10 bg-muted/20 aspect-video flex items-center justify-center",children:u&&!j?a.jsx("img",{src:u,alt:"Ù…Ø¹Ø§ÙŠÙ†Ø©",className:"w-full h-full object-cover",onError:()=>f(!0)}):a.jsxs("div",{className:"text-muted-foreground text-xs flex flex-col items-center gap-2",children:[a.jsx(n,{className:"w-8 h-8 opacity-30"}),a.jsx("span",{children:j?"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± ØµØ­ÙŠØ­":"Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©"})]})})]})})]}),a.jsx($,{control:w.control,name:"excerpt",render:({field:e})=>a.jsxs(Q,{children:[a.jsx(R,{className:"text-xs",children:"Ù…Ù„Ø®Øµ Ù‚ØµÙŠØ±"}),a.jsx(H,{children:a.jsx(X,{placeholder:"Ù…Ù„Ø®Øµ Ù…Ø®ØªØµØ± ÙŠØ¸Ù‡Ø± ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª...",...e,className:"min-h-[60px] bg-background/50 resize-none text-sm"})}),a.jsx(J,{className:"text-[10px]"})]})}),a.jsx($,{control:w.control,name:"content",render:({field:e})=>a.jsxs(Q,{children:[a.jsx(R,{className:"text-xs",children:"Ø§Ù„Ù…Ø­ØªÙˆÙ‰ *"}),a.jsx(H,{children:a.jsx(X,{placeholder:"Ø§ÙƒØªØ¨ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚Ø§Ù„ Ù‡Ù†Ø§...",...e,className:"min-h-[200px] bg-background/50 resize-none text-sm"})}),a.jsx(J,{className:"text-[10px]"})]})}),a.jsx($,{control:w.control,name:"is_published",render:({field:e})=>a.jsxs(Q,{className:"flex items-center justify-between rounded-lg border border-white/10 p-3 bg-muted/10",children:[a.jsxs("div",{className:"space-y-0.5",children:[a.jsx(R,{className:"text-sm",children:"Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø§Ù„"}),a.jsx(M,{className:"text-xs",children:"Ø¹Ù†Ø¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ØŒ Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ù…Ù‚Ø§Ù„ Ù„Ù„Ø¬Ù…ÙŠØ¹"})]}),a.jsx(H,{children:a.jsx(Y,{checked:e.value,onCheckedChange:e.onChange})})]})})]})})}),a.jsxs(I,{className:"p-4 border-t border-white/5 bg-background shrink-0 flex-row gap-2",children:[a.jsx(g,{type:"button",variant:"outline",onClick:()=>o(!1),className:"flex-1 h-9",children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsx(g,{type:"submit",form:"post-form",disabled:k.isPending,className:"flex-1 h-9 bg-gradient-to-r from-neon-purple to-neon-blue hover:opacity-90",children:k.isPending?a.jsx(l,{className:"w-4 h-4 animate-spin"}):v?"Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª":"Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø§Ù„"})]})]})})},re=()=>{const[t,n]=s.useState(!1),[z,E]=s.useState(null),[P,q]=s.useState(null);U();const{isAdmin:F}=Z(),{toast:V}=O(),L=e(),{data:T,isLoading:B,error:G}=i({queryKey:["posts"],queryFn:async()=>{const e=h.from("posts").select("*").order("created_at",{ascending:!1});F||e.eq("is_published",!0);const{data:s,error:t}=await e;if(t)throw t;return s}}),I=r({mutationFn:async e=>{const{error:s}=await h.from("posts").delete().eq("id",e);if(s)throw s},onSuccess:()=>{V({title:"ğŸ—‘ï¸ ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­",className:"bg-red-500/10 text-red-500"}),L.invalidateQueries({queryKey:["posts"]}),q(null)},onError:()=>{V({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„",variant:"destructive"})}}),K=(e,s=150)=>{const t=e.excerpt||e.content;return t.length<=s?t:t.substring(0,s).trim()+"..."},$=()=>{E(null),n(!0)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",dir:"rtl",children:[a.jsx(C,{onAddClick:$}),a.jsxs("main",{className:"flex-1 container mx-auto max-w-7xl px-4 py-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl sm:text-4xl font-bold gradient-text mb-2",children:"Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©"}),a.jsx("p",{className:"text-muted-foreground",children:"Ø£Ø­Ø¯Ø« Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ÙˆØ§Ù„Ø£Ø®Ø¨Ø§Ø± Ø¹Ù† Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ"})]}),F&&a.jsxs(g,{onClick:$,className:"bg-gradient-to-r from-neon-purple to-neon-blue hover:opacity-90 gap-2",children:[a.jsx(o,{className:"h-4 w-4"}),"Ù…Ù‚Ø§Ù„ Ø¬Ø¯ÙŠØ¯"]})]}),B&&a.jsx("div",{className:"flex justify-center items-center py-20 min-h-[400px]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx(l,{className:"h-12 w-12 animate-spin text-neon-purple"}),a.jsx("span",{className:"text-muted-foreground animate-pulse",children:"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª..."})]})}),G&&a.jsxs("div",{className:"text-center py-20 min-h-[400px] flex flex-col justify-center items-center",children:[a.jsx("div",{className:"bg-destructive/10 p-4 rounded-full mb-4",children:a.jsx(c,{className:"h-8 w-8 text-destructive"})}),a.jsx("p",{className:"text-xl font-bold text-destructive mb-2",children:"Ø­Ø¯Ø« Ø®Ø·Ø£"}),a.jsx("p",{className:"text-muted-foreground",children:"ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª"})]}),!B&&!G&&(!T||0===T.length)&&a.jsxs("div",{className:"text-center py-20 min-h-[400px] flex flex-col justify-center items-center",children:[a.jsx("div",{className:"w-16 h-16 bg-muted/50 rounded-2xl flex items-center justify-center mb-4 text-3xl opacity-50",children:"ğŸ“"}),a.jsx("p",{className:"text-xl font-semibold text-foreground",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‚Ø§Ù„Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹"}),a.jsx("p",{className:"text-muted-foreground mt-2 max-w-xs mx-auto",children:"ÙƒÙ† Ø£ÙˆÙ„ Ù…Ù† ÙŠØ´Ø§Ø±Ùƒ Ù…Ù‚Ø§Ù„Ø§Ù‹!"}),F&&a.jsxs(g,{onClick:$,className:"mt-6 bg-gradient-to-r from-neon-purple to-neon-blue hover:opacity-90 gap-2",children:[a.jsx(o,{className:"h-4 w-4"}),"Ø£Ø¶Ù Ø£ÙˆÙ„ Ù…Ù‚Ø§Ù„"]})]}),!B&&!G&&T&&T.length>0&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(e=>a.jsxs("article",{className:"group relative glass-card rounded-2xl overflow-hidden border border-white/5 hover:border-neon-purple/30 transition-all duration-300 hover:shadow-lg hover:shadow-neon-purple/10",children:[F&&a.jsxs("div",{className:"absolute top-3 left-3 z-10 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsx(g,{variant:"ghost",size:"icon",onClick:()=>(e=>{E(e),n(!0)})(e),className:"h-8 w-8 bg-background/80 backdrop-blur-sm hover:bg-neon-purple/20 hover:text-neon-purple",children:a.jsx(d,{className:"w-4 h-4"})}),a.jsx(g,{variant:"ghost",size:"icon",onClick:()=>q(e),className:"h-8 w-8 bg-background/80 backdrop-blur-sm hover:bg-destructive/20 hover:text-destructive",children:a.jsx(m,{className:"w-4 h-4"})})]}),F&&!e.is_published&&a.jsxs(j,{className:"absolute top-3 right-3 z-10 bg-yellow-500/20 text-yellow-500 border-yellow-500/30",children:[a.jsx(x,{className:"w-3 h-3 mr-1"}),"Ù…Ø³ÙˆØ¯Ø©"]}),e.image_url&&a.jsx("div",{className:"aspect-video overflow-hidden bg-muted/20",children:a.jsx("img",{src:e.image_url,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",loading:"lazy"})}),!e.image_url&&a.jsx("div",{className:"aspect-video bg-gradient-to-br from-neon-purple/20 to-neon-blue/20 flex items-center justify-center",children:a.jsx(c,{className:"w-12 h-12 text-muted-foreground/30"})}),a.jsxs("div",{className:"p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-3",children:[a.jsx(u,{className:"w-3 h-3"}),a.jsx("time",{dateTime:e.created_at,children:A(new Date(e.created_at),"PPP",{locale:D})})]}),a.jsx("h2",{className:"text-lg font-bold text-foreground mb-2 line-clamp-2 group-hover:text-neon-purple transition-colors",children:e.title}),a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:K(e)}),a.jsxs("button",{className:"mt-4 text-sm font-medium text-neon-purple hover:text-neon-blue transition-colors flex items-center gap-1",children:[a.jsx(p,{className:"w-4 h-4"}),"Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø²ÙŠØ¯"]})]})]},e.id))})]}),a.jsx(S,{}),a.jsx(te,{open:t,onOpenChange:e=>{n(e),e||E(null)},postToEdit:z}),a.jsx(f,{open:!!P,onOpenChange:e=>!e&&q(null),children:a.jsxs(b,{dir:"rtl",children:[a.jsxs(N,{children:[a.jsx(v,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ"}),a.jsxs(w,{children:['Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‚Ø§Ù„ "',null==P?void 0:P.title,'" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.']})]}),a.jsxs(y,{className:"flex-row-reverse gap-2",children:[a.jsx(_,{children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsx(k,{onClick:()=>P&&I.mutate(P.id),className:"bg-destructive hover:bg-destructive/90",disabled:I.isPending,children:I.isPending?a.jsx(l,{className:"w-4 h-4 animate-spin"}):"Ø­Ø°Ù"})]})]})})]})};export{re as default};
