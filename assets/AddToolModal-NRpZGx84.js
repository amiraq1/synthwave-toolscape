import{r as b,j as e}from"./react-core-DF6eTxSH.js";import{u as $,a as G,t as H,o as N,c as k,s as l,l as R}from"./forms-BgQR_J8a.js";import{b as X,c as J}from"./tanstack-C82ICjHp.js";import{s as y}from"./client-BQnz2r4z.js";import{u as U}from"./index-DDY7f-67.js";import{D as F,a as S,c as T,e as C,b as W,d as Y}from"./dialog-CHCWic0Y.js";import{F as Z,a as i,b as c,c as n,d as o,e as p}from"./form-DrvjJc5B.js";import{B as d}from"./button-BmB2E3hl.js";import{I as j}from"./input-C88N8BI7.js";import{T as O}from"./textarea-BZxigRQZ.js";import{S as D,a as V,b as _,c as I,d as A}from"./select-322zLXRG.js";import{b as ee}from"./router-BDgXhDEa.js";import{a9 as se,ad as te,K as ae,L as E,S as re,N as le,X as ie}from"./icons-D1KRm4qg.js";import"./supabase-BI1TbgRl.js";import"./ui-primitives-B-Kf-2xP.js";import"./label-BKsU_jwr.js";const ne=["ŸÜÿµŸàÿµ","ÿµŸàÿ±","ŸÅŸäÿØŸäŸà","ÿ®ÿ±ŸÖÿ¨ÿ©","ÿ•ŸÜÿ™ÿßÿ¨Ÿäÿ©","ÿØÿ±ÿßÿ≥ÿ© Ÿàÿ∑ŸÑÿßÿ®","ÿµŸàÿ™"],ce=["ŸÖÿ¨ÿßŸÜŸä","ŸÖÿØŸÅŸàÿπ"],oe=N({title:l().min(2,"ÿßŸÑÿßÿ≥ŸÖ ŸÇÿµŸäÿ± ÿ¨ÿØÿßŸã"),description:l().min(10,"ÿßŸÑŸàÿµŸÅ ŸÇÿµŸäÿ± ÿ¨ÿØÿßŸã").max(500),url:l().url("ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠"),image_url:l().url("ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠").optional().or(R("")),category:l().min(1,"ŸÖÿ∑ŸÑŸàÿ®"),pricing_type:l(),features:k(N({value:l().min(1,"ŸÖÿ∑ŸÑŸàÿ®")})).optional(),screenshots:k(N({value:l().url("ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠")})).optional()}),Se=({open:u,onOpenChange:m})=>{const{toast:x}=U(),L=X(),z=ee(),[v,w]=b.useState(!1),[B,P]=b.useState(null),a=$({resolver:H(oe),defaultValues:{title:"",description:"",url:"",image_url:"",category:"",pricing_type:"ŸÖÿ¨ÿßŸÜŸä",features:[{value:""}],screenshots:[]}}),{fields:M,append:q,remove:K}=G({control:a.control,name:"features"});b.useEffect(()=>{u&&((async()=>{const{data:{session:t}}=await y.auth.getSession();P(!!t)})(),a.reset())},[u,a]);const Q=async()=>{const s=a.getValues("title"),t=a.getValues("description");if(!s.trim()||!t.trim()){x({title:"ÿ™ŸÜÿ®ŸäŸá",description:"ÿ£ÿØÿÆŸÑ ÿßŸÑÿßÿ≥ŸÖ ŸàÿßŸÑŸàÿµŸÅ ÿ£ŸàŸÑÿßŸã",variant:"destructive"});return}w(!0);try{const{data:r,error:h}=await y.functions.invoke("enhance-description",{body:{toolName:s,description:t}});if(h)throw h;r?.enhancedDescription&&(a.setValue("description",r.enhancedDescription,{shouldValidate:!0}),x({title:"‚ú® ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ"}))}catch{x({title:"ÿÆÿ∑ÿ£",description:"ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ",variant:"destructive"})}finally{w(!1)}},g=J({mutationFn:async s=>{const t=s.features?.map(f=>f.value).filter(Boolean)||[],r=s.screenshots?.map(f=>f.value).filter(Boolean)||[],{error:h}=await y.from("tools").insert([{title:s.title,description:s.description,url:s.url,image_url:s.image_url||null,category:s.category,pricing_type:s.pricing_type,features:t.length>0?t:null,screenshots:r.length>0?r:[]}]);if(h)throw h},onSuccess:()=>{x({title:"üéâ ÿ™ŸÖ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠",className:"bg-emerald-500/10 text-emerald-500"}),L.invalidateQueries({queryKey:["tools"]}),m(!1)},onError:()=>x({title:"ÿÆÿ∑ÿ£",description:"ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ŸÅÿ∏",variant:"destructive"})});return B===!1?e.jsx(F,{open:u,onOpenChange:m,children:e.jsxs(S,{className:"sm:max-w-xs p-6 text-center",dir:"rtl",children:[e.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:e.jsx(se,{className:"w-6 h-6 text-primary"})}),e.jsx(T,{className:"text-xl font-bold mb-2",children:"ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ"}),e.jsx(C,{className:"mb-6",children:"Ÿäÿ¨ÿ® ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿØŸàÿßÿ™."}),e.jsx(d,{onClick:()=>{m(!1),z("/auth")},className:"w-full",children:"ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ"})]})}):e.jsx(F,{open:u,onOpenChange:m,children:e.jsxs(S,{className:"sm:max-w-lg w-[95vw] max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden border-white/10 bg-background/95 backdrop-blur-xl",dir:"rtl",children:[e.jsxs(W,{className:"p-4 pb-2 border-b border-white/5 bg-muted/20 shrink-0",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(T,{className:"text-lg font-bold",children:"ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿØÿßÿ© ÿ¨ÿØŸäÿØÿ©"})}),e.jsx(C,{className:"text-xs",children:"ÿ¥ÿßÿ±ŸÉŸÜÿß ÿ£ÿØŸàÿßÿ™ ÿ∞ŸÉÿßÿ° ÿßÿµÿ∑ŸÜÿßÿπŸä ŸÖŸÅŸäÿØÿ©."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:e.jsx(Z,{...a,children:e.jsxs("form",{id:"add-tool-form",onSubmit:a.handleSubmit(s=>g.mutate(s)),className:"space-y-4 pb-4",children:[e.jsxs("div",{className:"space-y-3 bg-muted/10 p-3 rounded-lg border border-white/5",children:[e.jsx(i,{control:a.control,name:"title",render:({field:s})=>e.jsxs(c,{children:[e.jsx(n,{className:"text-xs",children:"ÿßÿ≥ŸÖ ÿßŸÑÿ£ÿØÿßÿ©"}),e.jsx(o,{children:e.jsx(j,{placeholder:"ŸÖÿ´ÿßŸÑ: ChatGPT",...s,className:"h-8 bg-background/50"})}),e.jsx(p,{className:"text-[10px]"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(i,{control:a.control,name:"category",render:({field:s})=>e.jsxs(c,{children:[e.jsx(n,{className:"text-xs",children:"ÿßŸÑÿ™ÿµŸÜŸäŸÅ"}),e.jsxs(D,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(V,{className:"h-8 bg-background/50",children:e.jsx(_,{placeholder:"ÿßÿÆÿ™ÿ±"})})}),e.jsx(I,{children:ne.map(t=>e.jsx(A,{value:t,children:t},t))})]}),e.jsx(p,{className:"text-[10px]"})]})}),e.jsx(i,{control:a.control,name:"pricing_type",render:({field:s})=>e.jsxs(c,{children:[e.jsx(n,{className:"text-xs",children:"ÿßŸÑÿ≥ÿπÿ±"}),e.jsxs(D,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(V,{className:"h-8 bg-background/50",children:e.jsx(_,{})})}),e.jsx(I,{children:ce.map(t=>e.jsx(A,{value:t,children:t},t))})]})]})})]})]}),e.jsxs("div",{className:"space-y-3 bg-muted/10 p-3 rounded-lg border border-white/5",children:[e.jsx(i,{control:a.control,name:"url",render:({field:s})=>e.jsxs(c,{children:[e.jsxs(n,{className:"text-xs flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"})," ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÖŸàŸÇÿπ"]}),e.jsx(o,{children:e.jsx(j,{placeholder:"https://...",dir:"ltr",...s,className:"h-8 bg-background/50"})}),e.jsx(p,{className:"text-[10px]"})]})}),e.jsx(i,{control:a.control,name:"image_url",render:({field:s})=>e.jsxs(c,{children:[e.jsxs(n,{className:"text-xs flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"})," ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ¥ÿπÿßÿ± (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)"]}),e.jsx(o,{children:e.jsx(j,{placeholder:"https://...",dir:"ltr",...s,className:"h-8 bg-background/50"})})]})})]}),e.jsx(i,{control:a.control,name:"description",render:({field:s})=>e.jsxs(c,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(n,{className:"text-xs",children:"ÿßŸÑŸàÿµŸÅ"}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:Q,disabled:v,className:"h-6 px-2 text-[10px] text-neon-purple hover:bg-neon-purple/10",children:v?e.jsx(E,{className:"w-3 h-3 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-3 h-3 mr-1"})," ÿ™ÿ≠ÿ≥ŸäŸÜ AI"]})})]}),e.jsx(o,{children:e.jsx(O,{placeholder:"ŸàÿµŸÅ ŸÖÿÆÿ™ÿµÿ±...",...s,className:"min-h-[80px] bg-background/50 resize-none text-sm"})}),e.jsx(p,{className:"text-[10px]"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(n,{className:"text-xs text-muted-foreground",children:"ÿßŸÑŸÖŸÖŸäÿ≤ÿßÿ™ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)"}),e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>q({value:""}),className:"h-6 w-6 p-0",children:e.jsx(le,{className:"w-4 h-4"})})]}),M.map((s,t)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{control:a.control,name:`features.${t}.value`,render:({field:r})=>e.jsx(j,{placeholder:`ŸÖŸäÿ≤ÿ© ${t+1}`,...r,className:"h-8 bg-background/50 text-xs"})}),e.jsx(d,{type:"button",variant:"ghost",size:"icon",onClick:()=>K(t),className:"h-8 w-8 text-destructive",children:e.jsx(ie,{className:"w-4 h-4"})})]},s.id))]})]})})}),e.jsxs(Y,{className:"p-4 border-t border-white/5 bg-background shrink-0 flex-row gap-2",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>m(!1),className:"flex-1 h-9",children:"ÿ•ŸÑÿ∫ÿßÿ°"}),e.jsx(d,{type:"submit",form:"add-tool-form",disabled:g.isPending,className:"flex-1 h-9 bg-primary hover:bg-primary/90",children:g.isPending?e.jsx(E,{className:"w-4 h-4 animate-spin"}):"ÿ≠ŸÅÿ∏"})]})]})})};export{Se as default};
