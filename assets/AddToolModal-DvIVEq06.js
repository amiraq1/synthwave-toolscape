import{G as e,E as s,r as a,aB as r,bj as t,I as l,j as n,be as i,bk as c,aC as o,L as d,S as m,aD as x,X as h}from"./react-vendor-DJsICmPt.js";import{a7 as p,a5 as u,aa as j,a6 as g,a9 as b}from"./vendor-Duk2WWTq.js";import{s as f}from"./client-BiGFyOmG.js";import{u as N}from"./index-BE1M6gq-.js";import{D as v,a as y,c as w,e as k,b as C,d as _}from"./dialog-Mxo7fRdL.js";import{F as V,a as S,b as z,c as B,d as D,e as E}from"./form-BJt_IcHt.js";import{B as F}from"./button-BU4y3P6j.js";import{I as G}from"./input-B5VEfAW3.js";import{T as I}from"./textarea-ONu2mWdl.js";import{S as O,a as P,b as T,c as $,d as q}from"./select-CcyCa7dw.js";import"./ui-vendor-BpqZfnrR.js";import"./supabase-vendor-CtVNLq9t.js";import"./label-BVYRnbjO.js";const A=["ŸÜÿµŸàÿµ","ÿµŸàÿ±","ŸÅŸäÿØŸäŸà","ÿ®ÿ±ŸÖÿ¨ÿ©","ÿ•ŸÜÿ™ÿßÿ¨Ÿäÿ©","ÿØÿ±ÿßÿ≥ÿ© Ÿàÿ∑ŸÑÿßÿ®","ÿµŸàÿ™"],K=["ŸÖÿ¨ÿßŸÜŸä","ŸÖÿØŸÅŸàÿπ"],L=u({title:g().min(2,"ÿßŸÑÿßÿ≥ŸÖ ŸÇÿµŸäÿ± ÿ¨ÿØÿßŸã"),description:g().min(10,"ÿßŸÑŸàÿµŸÅ ŸÇÿµŸäÿ± ÿ¨ÿØÿßŸã").max(500),url:g().url("ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠"),image_url:g().url("ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠").optional().or(b("")),category:g().min(1,"ŸÖÿ∑ŸÑŸàÿ®"),pricing_type:g(),features:j(u({value:g().min(1,"ŸÖÿ∑ŸÑŸàÿ®")})).optional(),screenshots:j(u({value:g().url("ÿ±ÿßÿ®ÿ∑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠")})).optional()}),Q=({open:u,onOpenChange:j})=>{const{toast:g}=N(),b=e(),Q=s(),[H,J]=a.useState(!1),[M,R]=a.useState(null),U=r({resolver:p(L),defaultValues:{title:"",description:"",url:"",image_url:"",category:"",pricing_type:"ŸÖÿ¨ÿßŸÜŸä",features:[{value:""}],screenshots:[]}}),{fields:W,append:X,remove:Y}=t({control:U.control,name:"features"});a.useEffect(()=>{if(u){(async()=>{const{data:{session:e}}=await f.auth.getSession();R(!!e)})(),U.reset()}},[u,U]);const Z=async()=>{const e=U.getValues("title"),s=U.getValues("description");if(e.trim()&&s.trim()){J(!0);try{const{data:a,error:r}=await f.functions.invoke("enhance-description",{body:{toolName:e,description:s}});if(r)throw r;(null==a?void 0:a.enhancedDescription)&&(U.setValue("description",a.enhancedDescription,{shouldValidate:!0}),g({title:"‚ú® ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ"}))}catch(a){g({title:"ÿÆÿ∑ÿ£",description:"ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ÿ≥ŸäŸÜ",variant:"destructive"})}finally{J(!1)}}else g({title:"ÿ™ŸÜÿ®ŸäŸá",description:"ÿ£ÿØÿÆŸÑ ÿßŸÑÿßÿ≥ŸÖ ŸàÿßŸÑŸàÿµŸÅ ÿ£ŸàŸÑÿßŸã",variant:"destructive"})},ee=l({mutationFn:async e=>{var s,a;const r=(null==(s=e.features)?void 0:s.map(e=>e.value).filter(Boolean))||[],t=(null==(a=e.screenshots)?void 0:a.map(e=>e.value).filter(Boolean))||[],{error:l}=await f.from("tools").insert([{title:e.title,description:e.description,url:e.url,image_url:e.image_url||null,category:e.category,pricing_type:e.pricing_type,features:r.length>0?r:null,screenshots:t.length>0?t:[]}]);if(l)throw l},onSuccess:()=>{g({title:"üéâ ÿ™ŸÖ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠",className:"bg-emerald-500/10 text-emerald-500"}),b.invalidateQueries({queryKey:["tools"]}),j(!1)},onError:()=>g({title:"ÿÆÿ∑ÿ£",description:"ŸÅÿ¥ŸÑ ÿßŸÑÿ≠ŸÅÿ∏",variant:"destructive"})});return!1===M?n.jsx(v,{open:u,onOpenChange:j,children:n.jsxs(y,{className:"sm:max-w-xs p-6 text-center",dir:"rtl",children:[n.jsx("div",{className:"mx-auto w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mb-4",children:n.jsx(i,{className:"w-6 h-6 text-primary"})}),n.jsx(w,{className:"text-xl font-bold mb-2",children:"ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ"}),n.jsx(k,{className:"mb-6",children:"Ÿäÿ¨ÿ® ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿØŸàÿßÿ™."}),n.jsx(F,{onClick:()=>{j(!1),Q("/auth")},className:"w-full",children:"ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ"})]})}):n.jsx(v,{open:u,onOpenChange:j,children:n.jsxs(y,{className:"sm:max-w-lg w-[95vw] max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden border-white/10 bg-background/95 backdrop-blur-xl",dir:"rtl",children:[n.jsxs(C,{className:"p-4 pb-2 border-b border-white/5 bg-muted/20 shrink-0",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx(w,{className:"text-lg font-bold",children:"ÿ•ÿ∂ÿßŸÅÿ© ÿ£ÿØÿßÿ© ÿ¨ÿØŸäÿØÿ©"})}),n.jsx(k,{className:"text-xs",children:"ÿ¥ÿßÿ±ŸÉŸÜÿß ÿ£ÿØŸàÿßÿ™ ÿ∞ŸÉÿßÿ° ÿßÿµÿ∑ŸÜÿßÿπŸä ŸÖŸÅŸäÿØÿ©."})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:n.jsx(V,{...U,children:n.jsxs("form",{id:"add-tool-form",onSubmit:U.handleSubmit(e=>ee.mutate(e)),className:"space-y-4 pb-4",children:[n.jsxs("div",{className:"space-y-3 bg-muted/10 p-3 rounded-lg border border-white/5",children:[n.jsx(S,{control:U.control,name:"title",render:({field:e})=>n.jsxs(z,{children:[n.jsx(B,{className:"text-xs",children:"ÿßÿ≥ŸÖ ÿßŸÑÿ£ÿØÿßÿ©"}),n.jsx(D,{children:n.jsx(G,{placeholder:"ŸÖÿ´ÿßŸÑ: ChatGPT",...e,className:"h-8 bg-background/50"})}),n.jsx(E,{className:"text-[10px]"})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(S,{control:U.control,name:"category",render:({field:e})=>n.jsxs(z,{children:[n.jsx(B,{className:"text-xs",children:"ÿßŸÑÿ™ÿµŸÜŸäŸÅ"}),n.jsxs(O,{onValueChange:e.onChange,defaultValue:e.value,children:[n.jsx(D,{children:n.jsx(P,{className:"h-8 bg-background/50",children:n.jsx(T,{placeholder:"ÿßÿÆÿ™ÿ±"})})}),n.jsx($,{children:A.map(e=>n.jsx(q,{value:e,children:e},e))})]}),n.jsx(E,{className:"text-[10px]"})]})}),n.jsx(S,{control:U.control,name:"pricing_type",render:({field:e})=>n.jsxs(z,{children:[n.jsx(B,{className:"text-xs",children:"ÿßŸÑÿ≥ÿπÿ±"}),n.jsxs(O,{onValueChange:e.onChange,defaultValue:e.value,children:[n.jsx(D,{children:n.jsx(P,{className:"h-8 bg-background/50",children:n.jsx(T,{})})}),n.jsx($,{children:K.map(e=>n.jsx(q,{value:e,children:e},e))})]})]})})]})]}),n.jsxs("div",{className:"space-y-3 bg-muted/10 p-3 rounded-lg border border-white/5",children:[n.jsx(S,{control:U.control,name:"url",render:({field:e})=>n.jsxs(z,{children:[n.jsxs(B,{className:"text-xs flex items-center gap-1",children:[n.jsx(c,{className:"w-3 h-3"})," ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÖŸàŸÇÿπ"]}),n.jsx(D,{children:n.jsx(G,{placeholder:"https://...",dir:"ltr",...e,className:"h-8 bg-background/50"})}),n.jsx(E,{className:"text-[10px]"})]})}),n.jsx(S,{control:U.control,name:"image_url",render:({field:e})=>n.jsxs(z,{children:[n.jsxs(B,{className:"text-xs flex items-center gap-1",children:[n.jsx(o,{className:"w-3 h-3"})," ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ¥ÿπÿßÿ± (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)"]}),n.jsx(D,{children:n.jsx(G,{placeholder:"https://...",dir:"ltr",...e,className:"h-8 bg-background/50"})})]})})]}),n.jsx(S,{control:U.control,name:"description",render:({field:e})=>n.jsxs(z,{children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(B,{className:"text-xs",children:"ÿßŸÑŸàÿµŸÅ"}),n.jsx(F,{type:"button",variant:"ghost",size:"sm",onClick:Z,disabled:H,className:"h-6 px-2 text-[10px] text-neon-purple hover:bg-neon-purple/10",children:H?n.jsx(d,{className:"w-3 h-3 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(m,{className:"w-3 h-3 mr-1"})," ÿ™ÿ≠ÿ≥ŸäŸÜ AI"]})})]}),n.jsx(D,{children:n.jsx(I,{placeholder:"ŸàÿµŸÅ ŸÖÿÆÿ™ÿµÿ±...",...e,className:"min-h-[80px] bg-background/50 resize-none text-sm"})}),n.jsx(E,{className:"text-[10px]"})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(B,{className:"text-xs text-muted-foreground",children:"ÿßŸÑŸÖŸÖŸäÿ≤ÿßÿ™ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)"}),n.jsx(F,{type:"button",variant:"ghost",size:"sm",onClick:()=>X({value:""}),className:"h-6 w-6 p-0",children:n.jsx(x,{className:"w-4 h-4"})})]}),W.map((e,s)=>n.jsxs("div",{className:"flex gap-2",children:[n.jsx(S,{control:U.control,name:`features.${s}.value`,render:({field:e})=>n.jsx(G,{placeholder:`ŸÖŸäÿ≤ÿ© ${s+1}`,...e,className:"h-8 bg-background/50 text-xs"})}),n.jsx(F,{type:"button",variant:"ghost",size:"icon",onClick:()=>Y(s),className:"h-8 w-8 text-destructive",children:n.jsx(h,{className:"w-4 h-4"})})]},e.id))]})]})})}),n.jsxs(_,{className:"p-4 border-t border-white/5 bg-background shrink-0 flex-row gap-2",children:[n.jsx(F,{type:"button",variant:"outline",onClick:()=>j(!1),className:"flex-1 h-9",children:"ÿ•ŸÑÿ∫ÿßÿ°"}),n.jsx(F,{type:"submit",form:"add-tool-form",disabled:ee.isPending,className:"flex-1 h-9 bg-primary hover:bg-primary/90",children:ee.isPending?n.jsx(d,{className:"w-4 h-4 animate-spin"}):"ÿ≠ŸÅÿ∏"})]})]})})};export{Q as default};
