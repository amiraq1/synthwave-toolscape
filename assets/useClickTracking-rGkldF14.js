import{u as n,b as a}from"./tanstack-C82ICjHp.js";import{s as c}from"./client-BQnz2r4z.js";import{r as l}from"./react-core-DF6eTxSH.js";const s=async r=>{const{data:o,error:e}=await c.from("tools").select("*").eq("id",parseInt(r)).maybeSingle();if(e)throw e;if(!o)throw new Error("Tool not found");return o},f=r=>n({queryKey:["tool",r],queryFn:()=>s(r),enabled:!!r,staleTime:1e3*60*5}),d=()=>{const r=a();return o=>{const e=String(o);r.getQueryData(["tool",e])||r.prefetchQuery({queryKey:["tool",e],queryFn:()=>s(e),staleTime:1e3*60*5})}},m=()=>({recordClick:l.useCallback(async o=>{const e=Number(o);if(isNaN(e)){console.error("Invalid tool ID:",o);return}try{const{error:t}=await c.rpc("record_tool_click",{p_tool_id:e,p_referrer:document.referrer||null,p_user_agent:navigator.userAgent||null});t&&console.error("Error recording click:",t)}catch(t){console.error("Failed to track click:",t)}},[])});export{m as a,d as b,f as u};
