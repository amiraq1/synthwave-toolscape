import{r as d,j as e}from"./react-core-DF6eTxSH.js";import{B as m}from"./button-C_lhRWi6.js";import{d as se,L as B,e as H,f as F}from"./ui-primitives-B-Kf-2xP.js";import{c as A,u as O}from"./index-DsAfhvWl.js";import{u as ae}from"./useAdminCheck-BdETsJDW.js";import{I as S}from"./input-CZnHCbQJ.js";import{T as te}from"./textarea-6ZxLVo_j.js";import{B as p}from"./badge-CHfEu4tN.js";import{T as Q,a as V,b as T,c as x,d as $,e as h}from"./table-vr5NfP2w.js";import{D as re,a as ie,b as le,c as ne,d as ce}from"./dialog-Cgsd2ihy.js";import{A as W,a as K,b as G,c as P,d as X,e as J,f as M,g as Y}from"./alert-dialog-DpaRLqVS.js";import{S as R,a as L,b as I,c as z,d as E}from"./select-BE_M6TsH.js";import{u as de}from"./useTools-veyYLaWw.js";import{s as f}from"./client-BQnz2r4z.js";import{b as oe}from"./tanstack-C82ICjHp.js";import{L as N,E as me,x as xe,T as he,y as U,z as q,F as ue,G as ge,H as je,g as pe,W as fe,I as Ne}from"./icons-D1KRm4qg.js";import{u as ve}from"./useAuth-Kj5IyosW.js";import{u as be}from"./useSEO-BC7slwlt.js";import{b as ye}from"./router-6Sp3h7Hu.js";import"./supabase-BI1TbgRl.js";const we=se,Z=d.forwardRef(({className:i,...r},t)=>e.jsx(B,{ref:t,className:A("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",i),...r}));Z.displayName=B.displayName;const k=d.forwardRef(({className:i,...r},t)=>e.jsx(H,{ref:t,className:A("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",i),...r}));k.displayName=H.displayName;const D=d.forwardRef(({className:i,...r},t)=>e.jsx(F,{ref:t,className:A("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),...r}));D.displayName=F.displayName;const _e=["Ù†ØµÙˆØµ","ØµÙˆØ±","ÙÙŠØ¯ÙŠÙˆ","Ø¨Ø±Ù…Ø¬Ø©","Ø¥Ù†ØªØ§Ø¬ÙŠØ©","Ø¯Ø±Ø§Ø³Ø© ÙˆØ·Ù„Ø§Ø¨"],Ce=["Ù…Ø¬Ø§Ù†ÙŠ","Ù…Ø¯ÙÙˆØ¹","Ù…Ø¬Ø§Ù†ÙŠ Ø¬Ø²Ø¦ÙŠØ§Ù‹"],Te=()=>{const{data:i,isLoading:r}=de("","Ø§Ù„ÙƒÙ„"),{toast:t}=O(),y=oe(),w=i?.pages.flat()??[],[g,l]=d.useState(null),[o,j]=d.useState(null),[v,b]=d.useState(!1),[_,C]=d.useState(!1),[a,n]=d.useState({title:"",description:"",url:"",category:"",pricing_type:"",image_url:""}),c=s=>{l(s),n({title:s.title,description:s.description,url:s.url,category:s.category,pricing_type:s.pricing_type,image_url:s.image_url||""})},u=async()=>{if(g){b(!0);try{const{error:s}=await f.from("tools").update({title:a.title,description:a.description,url:a.url,category:a.category,pricing_type:a.pricing_type,image_url:a.image_url||null}).eq("id",g.id);if(s)throw s;t({title:"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«",description:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­"}),y.invalidateQueries({queryKey:["tools"]}),l(null)}catch(s){t({title:"Ø®Ø·Ø£",description:s.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ø§Ø©",variant:"destructive"})}finally{b(!1)}}},ee=async()=>{if(o){C(!0);try{const{error:s}=await f.from("tools").delete().eq("id",o.id);if(s)throw s;t({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­"}),y.invalidateQueries({queryKey:["tools"]}),j(null)}catch(s){t({title:"Ø®Ø·Ø£",description:s.message||"ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø©",variant:"destructive"})}finally{C(!1)}}};return r?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(N,{className:"h-8 w-8 animate-spin text-neon-purple"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-bold",children:["Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª (",w.length,")"]})}),e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs(Q,{children:[e.jsx(V,{children:e.jsxs(T,{className:"bg-muted/50",children:[e.jsx(x,{className:"text-right",children:"Ø§Ù„Ø£Ø¯Ø§Ø©"}),e.jsx(x,{className:"text-right",children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),e.jsx(x,{className:"text-right",children:"Ø§Ù„Ø³Ø¹Ø±"}),e.jsx(x,{className:"text-right",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsx($,{children:w.map(s=>e.jsxs(T,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:s.title,width:40,height:40,loading:"lazy",decoding:"async",className:"w-10 h-10 rounded-lg object-contain bg-white p-1"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-neon-purple to-neon-blue flex items-center justify-center text-lg",children:"ðŸ¤–"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 max-w-[200px]",children:s.description})]})]})}),e.jsx(h,{children:e.jsx(p,{variant:"secondary",className:"bg-neon-purple/20 text-neon-purple",children:s.category})}),e.jsx(h,{children:e.jsx(p,{variant:"secondary",className:s.pricing_type==="Ù…Ø¬Ø§Ù†ÙŠ"?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400",children:s.pricing_type})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>window.open(s.url,"_blank"),children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>c(s),children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>j(s),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},s.id))})]})}),e.jsx(re,{open:!!g,onOpenChange:()=>l(null),children:e.jsxs(ie,{className:"max-w-lg",dir:"rtl",children:[e.jsx(le,{children:e.jsx(ne,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø©"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©"}),e.jsx(S,{value:a.title,onChange:s=>n({...a,title:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ÙˆØµÙ"}),e.jsx(te,{value:a.description,onChange:s=>n({...a,description:s.target.value}),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø±Ø§Ø¨Ø·"}),e.jsx(S,{value:a.url,onChange:s=>n({...a,url:s.target.value}),dir:"ltr"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),e.jsxs(R,{value:a.category,onValueChange:s=>n({...a,category:s}),children:[e.jsx(L,{children:e.jsx(I,{})}),e.jsx(z,{children:_e.map(s=>e.jsx(E,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ù†ÙˆØ¹ Ø§Ù„ØªØ³Ø¹ÙŠØ±"}),e.jsxs(R,{value:a.pricing_type,onValueChange:s=>n({...a,pricing_type:s}),children:[e.jsx(L,{children:e.jsx(I,{})}),e.jsx(z,{children:Ce.map(s=>e.jsx(E,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx(S,{value:a.image_url,onChange:s=>n({...a,image_url:s.target.value}),dir:"ltr",placeholder:"https://..."})]})]}),e.jsxs(ce,{children:[e.jsx(m,{variant:"outline",onClick:()=>l(null),children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsxs(m,{onClick:u,disabled:v,children:[v&&e.jsx(N,{className:"h-4 w-4 animate-spin ml-2"}),"Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª"]})]})]})}),e.jsx(W,{open:!!o,onOpenChange:()=>j(null),children:e.jsxs(K,{dir:"rtl",children:[e.jsxs(G,{children:[e.jsx(P,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ"}),e.jsxs(X,{children:['Ø³ÙŠØªÙ… Ø­Ø°Ù "',o?.title,'" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.']})]}),e.jsxs(J,{className:"flex-row-reverse gap-2",children:[e.jsx(M,{children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsxs(Y,{onClick:ee,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:_,children:[_&&e.jsx(N,{className:"h-4 w-4 animate-spin ml-2"}),"Ø­Ø°Ù"]})]})]})})]})},Se=()=>{const{user:i}=ve(),{toast:r}=O(),[t,y]=d.useState([]),[w,g]=d.useState(!0),[l,o]=d.useState(null),[j,v]=d.useState(!1),b=async()=>{g(!0);try{const{data:a,error:n}=await f.rpc("admin_get_users");if(n)throw n;const c=(a||[]).map(u=>({id:u.user_id,email:u.email||null,display_name:u.display_name,created_at:u.created_at,role:u.role||null}));y(c)}catch{r({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",variant:"destructive"})}finally{g(!1)}};d.useEffect(()=>{b()},[]);const _=async()=>{if(!l)return;const{user:a,newRole:n}=l;v(!0);try{if(n===null){const{error:c}=await f.from("user_roles").delete().eq("user_id",a.id);if(c)throw c}else if(a.role===null){const{error:c}=await f.from("user_roles").insert({user_id:a.id,role:n});if(c)throw c}else{const{error:c}=await f.from("user_roles").update({role:n}).eq("user_id",a.id);if(c)throw c}r({title:"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«",description:`ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙ„Ø§Ø­ÙŠØ§Øª ${a.display_name||a.email}`}),b()}catch(c){r({title:"Ø®Ø·Ø£",description:c.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª",variant:"destructive"})}finally{v(!1),o(null)}},C=a=>{switch(a){case"admin":return e.jsxs(p,{className:"bg-red-500/20 text-red-400 border-red-500/30",children:[e.jsx(U,{className:"h-3 w-3 ml-1"}),"Ù…Ø¯ÙŠØ±"]});case"moderator":return e.jsxs(p,{className:"bg-amber-500/20 text-amber-400 border-amber-500/30",children:[e.jsx(q,{className:"h-3 w-3 ml-1"}),"Ù…Ø´Ø±Ù"]});default:return e.jsx(p,{variant:"secondary",className:"bg-muted text-muted-foreground",children:"Ù…Ø³ØªØ®Ø¯Ù…"})}};return w?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(N,{className:"h-8 w-8 animate-spin text-neon-purple"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-bold",children:["Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (",t.length,")"]})}),e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsxs(Q,{children:[e.jsx(V,{children:e.jsxs(T,{className:"bg-muted/50",children:[e.jsx(x,{className:"text-right",children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),e.jsx(x,{className:"text-right",children:"Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©"}),e.jsx(x,{className:"text-right",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„"}),e.jsx(x,{className:"text-right",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsx($,{children:t.map(a=>e.jsxs(T,{children:[e.jsx(h,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.display_name||"Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.email})]})}),e.jsx(h,{children:C(a.role)}),e.jsx(h,{className:"text-sm text-muted-foreground",children:new Date(a.created_at).toLocaleDateString("ar-IQ")}),e.jsx(h,{children:a.id!==i?.id?e.jsxs("div",{className:"flex items-center gap-1",children:[a.role!=="admin"&&e.jsx(m,{size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-400 hover:bg-red-500/10",onClick:()=>o({user:a,newRole:"admin"}),children:e.jsx(U,{className:"h-4 w-4"})}),a.role!=="moderator"&&e.jsx(m,{size:"sm",variant:"ghost",className:"text-amber-400 hover:text-amber-400 hover:bg-amber-500/10",onClick:()=>o({user:a,newRole:"moderator"}),children:e.jsx(q,{className:"h-4 w-4"})}),a.role&&e.jsx(m,{size:"sm",variant:"ghost",className:"text-muted-foreground hover:text-foreground",onClick:()=>o({user:a,newRole:null}),children:e.jsx(ue,{className:"h-4 w-4"})})]}):e.jsx(p,{variant:"outline",className:"text-xs",children:"Ø£Ù†Øª"})})]},a.id))})]})}),e.jsx(W,{open:!!l,onOpenChange:()=>o(null),children:e.jsxs(K,{dir:"rtl",children:[e.jsxs(G,{children:[e.jsx(P,{children:"ØªØºÙŠÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª"}),e.jsx(X,{children:l?.newRole===null?`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ù† "${l?.user.display_name||l?.user.email}"ØŸ`:`Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ù†Ø­ "${l?.user.display_name||l?.user.email}" ØµÙ„Ø§Ø­ÙŠØ© ${l?.newRole==="admin"?"Ø§Ù„Ù…Ø¯ÙŠØ±":"Ø§Ù„Ù…Ø´Ø±Ù"}ØŸ`})]}),e.jsxs(J,{className:"flex-row-reverse gap-2",children:[e.jsx(M,{children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsxs(Y,{onClick:_,disabled:j,children:[j&&e.jsx(N,{className:"h-4 w-4 animate-spin ml-2"}),"ØªØ£ÙƒÙŠØ¯"]})]})]})})]})},Pe=()=>{be({title:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",description:"Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",noIndex:!0});const i=ye(),{isAdmin:r,loading:t}=ae();return d.useEffect(()=>{!t&&!r&&i("/")},[r,t,i]),t?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(N,{className:"h-12 w-12 animate-spin text-neon-purple mx-auto"}),e.jsx("p",{className:"text-muted-foreground",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª..."})]})}):r?e.jsxs("div",{className:"min-h-screen bg-background",dir:"rtl",children:[e.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/50",children:e.jsx("div",{className:"container mx-auto max-w-7xl px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"h-6 w-6 text-neon-purple"}),e.jsx("h1",{className:"text-xl font-bold",children:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"})]}),e.jsxs(m,{variant:"ghost",onClick:()=>i("/"),className:"gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),"Ø§Ù„Ø¹ÙˆØ¯Ø©"]})]})})}),e.jsx("main",{className:"container mx-auto max-w-7xl px-4 py-8",children:e.jsxs(we,{defaultValue:"tools",className:"space-y-6",children:[e.jsxs(Z,{className:"grid w-full max-w-md grid-cols-2 mx-auto",children:[e.jsxs(k,{value:"tools",className:"gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Ø§Ù„Ø£Ø¯ÙˆØ§Øª"]}),e.jsxs(k,{value:"users",className:"gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"]})]}),e.jsx(D,{value:"tools",className:"glass rounded-xl p-6",children:e.jsx(Te,{})}),e.jsx(D,{value:"users",className:"glass rounded-xl p-6",children:e.jsx(Se,{})})]})})]}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(ge,{className:"h-16 w-16 text-destructive mx-auto"}),e.jsx("h1",{className:"text-2xl font-bold",children:"ØºÙŠØ± Ù…ØµØ±Ø­"}),e.jsx("p",{className:"text-muted-foreground",children:"Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©"}),e.jsx(m,{onClick:()=>i("/"),children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})})};export{Pe as default};
