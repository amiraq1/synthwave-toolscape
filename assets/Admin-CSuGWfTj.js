import{aa as e,r as s,j as a,ab as r,ac as t,ad as i,v as l,L as n,W as c,ae as d,E as o,af as m,ag as x,ah as h,ai as u,aj as j,G as p,ak as g,al as f}from"./react-core-Ds-4081u.js";import{B as N}from"./button-z3iXzSpy.js";import{c as v,u as b}from"./index-BjbHwrV-.js";import{u as y}from"./useAdminCheck-Bn9RcELw.js";import{I as w}from"./input-DRGlYIJe.js";import{T as _}from"./textarea-3BFPk-UV.js";import{B as k}from"./badge-BY-utw_d.js";import{T as C,a as S,b as R,c as z,d as q,e as A}from"./table-CAq9SQHS.js";import{D as E,a as I,b as D,c as O,d as $}from"./dialog-DtD38qR9.js";import{A as B,a as K,b as L,c as Q,d as T,e as V,f as G,g as J}from"./alert-dialog-CgfG3F12.js";import{S as W,a as F,b as H,c as M,d as P}from"./select-eClYMsyj.js";import{u as U}from"./useTools-Bw6y_YgD.js";import{s as X}from"./client-CroYBHHp.js";import{u as Y}from"./useAuth-PoIe4DG1.js";import{u as Z}from"./useSEO-6HQknDN3.js";import{b as ee}from"./react-router-BmNS8iat.js";import"./react-dom-CJlssZTM.js";import"./vendor-BS0l4q4C.js";import"./radix-ui-ByoYm48K.js";import"./tanstack-DamGjQ03.js";import"./markdown-01_NS6zS.js";import"./utils-Bmne0XXo.js";import"./supabase-CqVAhX3r.js";const se=e,ae=s.forwardRef(({className:e,...s},t)=>a.jsx(r,{ref:t,className:v("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));ae.displayName=r.displayName;const re=s.forwardRef(({className:e,...s},r)=>a.jsx(t,{ref:r,className:v("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...s}));re.displayName=t.displayName;const te=s.forwardRef(({className:e,...s},r)=>a.jsx(i,{ref:r,className:v("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));te.displayName=i.displayName;const ie=["Ù†ØµÙˆØµ","ØµÙˆØ±","ÙÙŠØ¯ÙŠÙˆ","Ø¨Ø±Ù…Ø¬Ø©","Ø¥Ù†ØªØ§Ø¬ÙŠØ©","Ø¯Ø±Ø§Ø³Ø© ÙˆØ·Ù„Ø§Ø¨"],le=["Ù…Ø¬Ø§Ù†ÙŠ","Ù…Ø¯ÙÙˆØ¹","Ù…Ø¬Ø§Ù†ÙŠ Ø¬Ø²Ø¦ÙŠØ§Ù‹"],ne=()=>{const{data:e,isLoading:r}=U("","Ø§Ù„ÙƒÙ„"),{toast:t}=b(),i=l(),m=e?.pages.flat()??[],[x,h]=s.useState(null),[u,j]=s.useState(null),[p,g]=s.useState(!1),[f,v]=s.useState(!1),[y,Y]=s.useState({title:"",description:"",url:"",category:"",pricing_type:"",image_url:""});return r?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(n,{className:"h-8 w-8 animate-spin text-neon-purple"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-xl font-bold",children:["Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª (",m.length,")"]})}),a.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:a.jsxs(C,{children:[a.jsx(S,{children:a.jsxs(R,{className:"bg-muted/50",children:[a.jsx(z,{className:"text-right",children:"Ø§Ù„Ø£Ø¯Ø§Ø©"}),a.jsx(z,{className:"text-right",children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),a.jsx(z,{className:"text-right",children:"Ø§Ù„Ø³Ø¹Ø±"}),a.jsx(z,{className:"text-right",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),a.jsx(q,{children:m.map(e=>a.jsxs(R,{children:[a.jsx(A,{children:a.jsxs("div",{className:"flex items-center gap-3",children:[e.image_url?a.jsx("img",{src:e.image_url,alt:e.title,width:40,height:40,loading:"lazy",decoding:"async",className:"w-10 h-10 rounded-lg object-contain bg-white p-1"}):a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-neon-purple to-neon-blue flex items-center justify-center text-lg",children:"ðŸ¤–"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:e.title}),a.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 max-w-[200px]",children:e.description})]})]})}),a.jsx(A,{children:a.jsx(k,{variant:"secondary",className:"bg-neon-purple/20 text-neon-purple",children:e.category})}),a.jsx(A,{children:a.jsx(k,{variant:"secondary",className:"Ù…Ø¬Ø§Ù†ÙŠ"===e.pricing_type?"bg-emerald-500/20 text-emerald-400":"bg-amber-500/20 text-amber-400",children:e.pricing_type})}),a.jsx(A,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(N,{size:"sm",variant:"ghost",onClick:()=>window.open(e.url,"_blank"),children:a.jsx(c,{className:"h-4 w-4"})}),a.jsx(N,{size:"sm",variant:"ghost",onClick:()=>(e=>{h(e),Y({title:e.title,description:e.description,url:e.url,category:e.category,pricing_type:e.pricing_type,image_url:e.image_url||""})})(e),children:a.jsx(d,{className:"h-4 w-4"})}),a.jsx(N,{size:"sm",variant:"ghost",className:"text-destructive hover:text-destructive",onClick:()=>j(e),children:a.jsx(o,{className:"h-4 w-4"})})]})})]},e.id))})]})}),a.jsx(E,{open:!!x,onOpenChange:()=>h(null),children:a.jsxs(I,{className:"max-w-lg",dir:"rtl",children:[a.jsx(D,{children:a.jsx(O,{children:"ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø©"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ø³Ù… Ø§Ù„Ø£Ø¯Ø§Ø©"}),a.jsx(w,{value:y.title,onChange:e=>Y({...y,title:e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ÙˆØµÙ"}),a.jsx(_,{value:y.description,onChange:e=>Y({...y,description:e.target.value}),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø±Ø§Ø¨Ø·"}),a.jsx(w,{value:y.url,onChange:e=>Y({...y,url:e.target.value}),dir:"ltr"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),a.jsxs(W,{value:y.category,onValueChange:e=>Y({...y,category:e}),children:[a.jsx(F,{children:a.jsx(H,{})}),a.jsx(M,{children:ie.map(e=>a.jsx(P,{value:e,children:e},e))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ù†ÙˆØ¹ Ø§Ù„ØªØ³Ø¹ÙŠØ±"}),a.jsxs(W,{value:y.pricing_type,onValueChange:e=>Y({...y,pricing_type:e}),children:[a.jsx(F,{children:a.jsx(H,{})}),a.jsx(M,{children:le.map(e=>a.jsx(P,{value:e,children:e},e))})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),a.jsx(w,{value:y.image_url,onChange:e=>Y({...y,image_url:e.target.value}),dir:"ltr",placeholder:"https://..."})]})]}),a.jsxs($,{children:[a.jsx(N,{variant:"outline",onClick:()=>h(null),children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsxs(N,{onClick:async()=>{if(x){g(!0);try{const{error:e}=await X.from("tools").update({title:y.title,description:y.description,url:y.url,category:y.category,pricing_type:y.pricing_type,image_url:y.image_url||null}).eq("id",parseInt(x.id));if(e)throw e;t({title:"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«",description:"ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­"}),i.invalidateQueries({queryKey:["tools"]}),h(null)}catch(e){t({title:"Ø®Ø·Ø£",description:e.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¯Ø§Ø©",variant:"destructive"})}finally{g(!1)}}},disabled:p,children:[p&&a.jsx(n,{className:"h-4 w-4 animate-spin ml-2"}),"Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª"]})]})]})}),a.jsx(B,{open:!!u,onOpenChange:()=>j(null),children:a.jsxs(K,{dir:"rtl",children:[a.jsxs(L,{children:[a.jsx(Q,{children:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ"}),a.jsxs(T,{children:['Ø³ÙŠØªÙ… Ø­Ø°Ù "',u?.title,'" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.']})]}),a.jsxs(V,{className:"flex-row-reverse gap-2",children:[a.jsx(G,{children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsxs(J,{onClick:async()=>{if(u){v(!0);try{const{error:e}=await X.from("tools").delete().eq("id",parseInt(u.id));if(e)throw e;t({title:"ØªÙ… Ø§Ù„Ø­Ø°Ù",description:"ØªÙ… Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­"}),i.invalidateQueries({queryKey:["tools"]}),j(null)}catch(e){t({title:"Ø®Ø·Ø£",description:e.message||"ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø£Ø¯Ø§Ø©",variant:"destructive"})}finally{v(!1)}}},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:f,children:[f&&a.jsx(n,{className:"h-4 w-4 animate-spin ml-2"}),"Ø­Ø°Ù"]})]})]})})]})},ce=()=>{const{user:e}=Y(),{toast:r}=b(),[t,i]=s.useState([]),[l,c]=s.useState(!0),[d,o]=s.useState(null),[u,j]=s.useState(!1),p=async()=>{c(!0);try{const{data:e,error:s}=await X.rpc("admin_get_users");if(s)throw s;const a=(e||[]).map(e=>({id:e.user_id,email:e.email||null,display_name:e.display_name,created_at:e.created_at,role:e.role||null}));i(a)}catch(e){r({title:"Ø®Ø·Ø£",description:"ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",variant:"destructive"})}finally{c(!1)}};s.useEffect(()=>{p()},[]);const g=e=>{switch(e){case"admin":return a.jsxs(k,{className:"bg-red-500/20 text-red-400 border-red-500/30",children:[a.jsx(m,{className:"h-3 w-3 ml-1"}),"Ù…Ø¯ÙŠØ±"]});case"moderator":return a.jsxs(k,{className:"bg-amber-500/20 text-amber-400 border-amber-500/30",children:[a.jsx(x,{className:"h-3 w-3 ml-1"}),"Ù…Ø´Ø±Ù"]});default:return a.jsx(k,{variant:"secondary",className:"bg-muted text-muted-foreground",children:"Ù…Ø³ØªØ®Ø¯Ù…"})}};return l?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(n,{className:"h-8 w-8 animate-spin text-neon-purple"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-xl font-bold",children:["Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (",t.length,")"]})}),a.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:a.jsxs(C,{children:[a.jsx(S,{children:a.jsxs(R,{className:"bg-muted/50",children:[a.jsx(z,{className:"text-right",children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),a.jsx(z,{className:"text-right",children:"Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©"}),a.jsx(z,{className:"text-right",children:"ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„"}),a.jsx(z,{className:"text-right",children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),a.jsx(q,{children:t.map(s=>a.jsxs(R,{children:[a.jsx(A,{children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:s.display_name||"Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]})}),a.jsx(A,{children:g(s.role)}),a.jsx(A,{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleDateString("ar-IQ")}),a.jsx(A,{children:s.id!==e?.id?a.jsxs("div",{className:"flex items-center gap-1",children:["admin"!==s.role&&a.jsx(N,{size:"sm",variant:"ghost",className:"text-red-400 hover:text-red-400 hover:bg-red-500/10",onClick:()=>o({user:s,newRole:"admin"}),children:a.jsx(m,{className:"h-4 w-4"})}),"moderator"!==s.role&&a.jsx(N,{size:"sm",variant:"ghost",className:"text-amber-400 hover:text-amber-400 hover:bg-amber-500/10",onClick:()=>o({user:s,newRole:"moderator"}),children:a.jsx(x,{className:"h-4 w-4"})}),s.role&&a.jsx(N,{size:"sm",variant:"ghost",className:"text-muted-foreground hover:text-foreground",onClick:()=>o({user:s,newRole:null}),children:a.jsx(h,{className:"h-4 w-4"})})]}):a.jsx(k,{variant:"outline",className:"text-xs",children:"Ø£Ù†Øª"})})]},s.id))})]})}),a.jsx(B,{open:!!d,onOpenChange:()=>o(null),children:a.jsxs(K,{dir:"rtl",children:[a.jsxs(L,{children:[a.jsx(Q,{children:"ØªØºÙŠÙŠØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª"}),a.jsx(T,{children:null===d?.newRole?`Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ù† "${d?.user.display_name||d?.user.email}"ØŸ`:`Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ù†Ø­ "${d?.user.display_name||d?.user.email}" ØµÙ„Ø§Ø­ÙŠØ© ${"admin"===d?.newRole?"Ø§Ù„Ù…Ø¯ÙŠØ±":"Ø§Ù„Ù…Ø´Ø±Ù"}ØŸ`})]}),a.jsxs(V,{className:"flex-row-reverse gap-2",children:[a.jsx(G,{children:"Ø¥Ù„ØºØ§Ø¡"}),a.jsxs(J,{onClick:async()=>{if(!d)return;const{user:e,newRole:s}=d;j(!0);try{if(null===s){const{error:s}=await X.from("user_roles").delete().eq("user_id",e.id);if(s)throw s}else if(null===e.role){const{error:a}=await X.from("user_roles").insert({user_id:e.id,role:s});if(a)throw a}else{const{error:a}=await X.from("user_roles").update({role:s}).eq("user_id",e.id);if(a)throw a}r({title:"ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«",description:`ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙ„Ø§Ø­ÙŠØ§Øª ${e.display_name||e.email}`}),p()}catch(a){r({title:"Ø®Ø·Ø£",description:a.message||"ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª",variant:"destructive"})}finally{j(!1),o(null)}},disabled:u,children:[u&&a.jsx(n,{className:"h-4 w-4 animate-spin ml-2"}),"ØªØ£ÙƒÙŠØ¯"]})]})]})})]})},de=()=>{Z({title:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…",description:"Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†",noIndex:!0});const e=ee(),{isAdmin:r,loading:t}=y();return s.useEffect(()=>{t||r||e("/")},[r,t,e]),t?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(n,{className:"h-12 w-12 animate-spin text-neon-purple mx-auto"}),a.jsx("p",{className:"text-muted-foreground",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª..."})]})}):r?a.jsxs("div",{className:"min-h-screen bg-background",dir:"rtl",children:[a.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/50",children:a.jsx("div",{className:"container mx-auto max-w-7xl px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(j,{className:"h-6 w-6 text-neon-purple"}),a.jsx("h1",{className:"text-xl font-bold",children:"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"})]}),a.jsxs(N,{variant:"ghost",onClick:()=>e("/"),className:"gap-2",children:[a.jsx(p,{className:"h-5 w-5"}),"Ø§Ù„Ø¹ÙˆØ¯Ø©"]})]})})}),a.jsx("main",{className:"container mx-auto max-w-7xl px-4 py-8",children:a.jsxs(se,{defaultValue:"tools",className:"space-y-6",children:[a.jsxs(ae,{className:"grid w-full max-w-md grid-cols-2 mx-auto",children:[a.jsxs(re,{value:"tools",className:"gap-2",children:[a.jsx(g,{className:"h-4 w-4"}),"Ø§Ù„Ø£Ø¯ÙˆØ§Øª"]}),a.jsxs(re,{value:"users",className:"gap-2",children:[a.jsx(f,{className:"h-4 w-4"}),"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"]})]}),a.jsx(te,{value:"tools",className:"glass rounded-xl p-6",children:a.jsx(ne,{})}),a.jsx(te,{value:"users",className:"glass rounded-xl p-6",children:a.jsx(ce,{})})]})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx(u,{className:"h-16 w-16 text-destructive mx-auto"}),a.jsx("h1",{className:"text-2xl font-bold",children:"ØºÙŠØ± Ù…ØµØ±Ø­"}),a.jsx("p",{className:"text-muted-foreground",children:"Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©"}),a.jsx(N,{onClick:()=>e("/"),children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})})};export{de as default};
