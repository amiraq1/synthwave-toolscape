import{r as e,j as s,ad as a,E as t,L as r,Y as l,U as i,a6 as n,ae as c,af as o,ag as d,ah as m,O as x}from"./react-vendor-DJsICmPt.js";import{B as u}from"./button-DbulzYd5.js";import{I as h}from"./input-Fa_FmzDN.js";import{L as p}from"./label-DiJ43kGo.js";import{S as f}from"./switch-B1CnplWK.js";import{c as j,u as g}from"./index-CmycUjlN.js";import{u as N}from"./useAuth-D5aF66GS.js";import{s as v}from"./client-BiGFyOmG.js";import{A as b,h as w,a as y,b as S,c as k,d as C,e as _,f as z,g as E}from"./alert-dialog-zDDkgOuL.js";import{u as I}from"./useSEO-BkuxEvtU.js";import"./vendor-Duk2WWTq.js";import"./ui-vendor-BpqZfnrR.js";import"./supabase-vendor-CtVNLq9t.js";const O=e.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...l},i)=>s.jsx(a,{ref:i,decorative:r,orientation:t,className:j("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...l}));O.displayName=a.displayName;const q="nabd_show_ratings",A="nabd_animations";function F(e,s=!0){try{const a=localStorage.getItem(e);return null===a?s:"false"!==a}catch{return s}}const L=()=>{I({title:"الإعدادات",description:"إدارة إعدادات حسابك وتفضيلاتك الشخصية في نبض",noIndex:!0});const a=t(),{user:j,signOut:L,loading:M}=N(),{toast:R}=g(),[B,D]=e.useState(""),[U,Y]=e.useState(!1),[G,H]=e.useState(!1),[J,K]=e.useState(!0),[P,Q]=e.useState(!0),T=e.useRef("");e.useEffect(()=>{K(F(q,!0)),Q(F(A,!0))},[]),e.useEffect(()=>{M||j||a("/auth",{replace:!0})},[j,M,a]),e.useEffect(()=>{(async()=>{var e,s;if(!j)return;const a=(null==(e=j.user_metadata)?void 0:e.display_name)??(null==(s=j.user_metadata)?void 0:s.full_name)??"";a&&!B&&(D(String(a)),T.current=String(a)),Y(!0);try{const{data:e,error:s}=await v.from("profiles").select("display_name").eq("id",j.id).maybeSingle();if(s)throw s;const t=((null==e?void 0:e.display_name)||a||"").toString();D(t),T.current=t}catch(t){}finally{Y(!1)}})()},[null==j?void 0:j.id]);const V=e.useMemo(()=>{if(!j)return!1;const e=B.trim();return e.length>0&&e!==T.current.trim()},[B,j]);return M||U?s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:s.jsx(r,{className:"h-12 w-12 animate-spin text-neon-purple"})}):j?s.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",dir:"rtl",children:[s.jsx("div",{className:"fixed top-0 left-1/4 w-72 sm:w-96 h-72 sm:h-96 bg-neon-purple/20 rounded-full blur-[120px] -z-10"}),s.jsx("div",{className:"fixed bottom-0 right-1/4 w-72 sm:w-96 h-72 sm:h-96 bg-neon-blue/20 rounded-full blur-[120px] -z-10"}),s.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/50",children:s.jsx("div",{className:"mx-auto w-full max-w-3xl px-4 py-4",children:s.jsxs(u,{onClick:()=>a("/",{replace:!0}),variant:"ghost",className:"gap-2 text-muted-foreground hover:text-foreground",children:[s.jsx(l,{className:"h-5 w-5"}),"العودة للرئيسية"]})})}),s.jsxs("main",{className:"mx-auto w-full max-w-3xl px-4 py-8 sm:py-12 space-y-8",children:[s.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-foreground",children:"الإعدادات"}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(i,{className:"h-6 w-6 text-neon-purple"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الملف الشخصي"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"email",className:"text-muted-foreground",children:"البريد الإلكتروني"}),s.jsxs("div",{className:"relative",children:[s.jsx(n,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(h,{id:"email",type:"email",value:j.email||"",disabled:!0,className:"pr-10 bg-muted/30 border-border/50 text-muted-foreground cursor-not-allowed"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(p,{htmlFor:"displayName",children:"اسم العرض"}),s.jsxs("div",{className:"relative",children:[s.jsx(i,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),s.jsx(h,{id:"displayName",type:"text",inputMode:"text",placeholder:"اسمك الذي يظهر للآخرين",value:B,onChange:e=>D(e.target.value),className:"pr-10 bg-muted/50 border-border/50"})]})]}),s.jsxs(u,{onClick:async()=>{if(!j)return;const e=B.trim();if(0!==e.length){H(!0);try{const{error:s}=await v.from("profiles").update({display_name:e}).eq("id",j.id);if(s)throw s;T.current=e,R({title:"تم الحفظ",description:"تم تحديث معلومات الملف الشخصي"})}catch(s){R({title:"خطأ",description:"حدث خطأ أثناء حفظ البيانات",variant:"destructive"})}finally{H(!1)}}else R({title:"اسم غير صالح",description:"يرجى إدخال اسم عرض صحيح",variant:"destructive"})},disabled:G||!V,className:"w-full sm:w-auto bg-gradient-to-r from-neon-purple to-neon-blue hover:opacity-90 gap-2",children:[G?s.jsx(r,{className:"h-4 w-4 animate-spin"}):s.jsx(c,{className:"h-4 w-4"}),"حفظ التغييرات"]})]})]}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(o,{className:"h-6 w-6 text-neon-purple"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"تفضيلات العرض"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3 py-3",children:[s.jsxs("div",{className:"space-y-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-foreground",children:"عرض التقييمات"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"إظهار تقييمات الأدوات في البطاقات"})]}),s.jsx(f,{checked:J,onCheckedChange:e=>{K(e);try{localStorage.setItem(q,String(e))}catch{}R({title:e?"تم تفعيل التقييمات":"تم إخفاء التقييمات",description:e?"ستظهر التقييمات في البطاقات":"تم إخفاء التقييمات من البطاقات"})}})]}),s.jsx(O,{className:"bg-border/50"}),s.jsxs("div",{className:"flex items-center justify-between gap-3 py-3",children:[s.jsxs("div",{className:"space-y-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-foreground",children:"الحركات والتأثيرات"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"تفعيل حركات الواجهة والانتقالات"})]}),s.jsx(f,{checked:P,onCheckedChange:e=>{Q(e);try{localStorage.setItem(A,String(e))}catch{}R({title:e?"تم تفعيل الحركات":"تم إيقاف الحركات",description:e?"ستظهر الحركات في الواجهة":"تم إيقاف حركات الواجهة"})}})]})]})]}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(d,{className:"h-6 w-6 text-neon-purple"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الإشعارات"})]}),s.jsx("p",{className:"text-muted-foreground",children:"إشعارات التطبيق غير متوفرة حالياً. سيتم إضافتها في تحديث قادم."})]}),s.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(m,{className:"h-6 w-6 text-destructive"}),s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الحساب"})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs(u,{onClick:async()=>{await L(),R({title:"تم تسجيل الخروج",description:"نراك قريباً!"}),a("/",{replace:!0})},variant:"outline",className:"w-full sm:w-auto gap-2 border-border/50",children:[s.jsx(m,{className:"h-4 w-4"}),"تسجيل الخروج"]}),s.jsxs(b,{children:[s.jsx(w,{asChild:!0,children:s.jsxs(u,{variant:"outline",className:"w-full sm:w-auto gap-2 border-destructive/50 text-destructive hover:bg-destructive/10",children:[s.jsx(x,{className:"h-4 w-4"}),"حذف الحساب"]})}),s.jsxs(y,{dir:"rtl",className:"glass",children:[s.jsxs(S,{children:[s.jsx(k,{children:"هل أنت متأكد من حذف الحساب؟"}),s.jsx(C,{children:"سيتم حذف حسابك نهائياً مع جميع المراجعات والبيانات المرتبطة به. هذا الإجراء لا يمكن التراجع عنه."})]}),s.jsxs(_,{className:"flex-row-reverse gap-2",children:[s.jsx(z,{className:"mt-0",children:"إلغاء"}),s.jsx(E,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>{R({title:"غير متوفر حالياً",description:"يرجى التواصل مع الدعم لحذف حسابك",variant:"destructive"})},children:"حذف الحساب"})]})]})]})]})]})]})]}):null};export{L as default};
