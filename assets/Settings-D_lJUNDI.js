import{r as a,j as e}from"./react-core-DF6eTxSH.js";import{B as m}from"./button-C_lhRWi6.js";import{I as w}from"./input-CZnHCbQJ.js";import{L as y}from"./label-DYNrWLl4.js";import{S}from"./switch-B3protxz.js";import{c as E}from"./ui-primitives-B-Kf-2xP.js";import{c as F,u as q}from"./index-DsAfhvWl.js";import{u as U}from"./useAuth-Kj5IyosW.js";import{s as A}from"./client-BQnz2r4z.js";import{A as H,h as K,a as Y,b as G,c as J,d as Q,e as W,f as X,g as Z}from"./alert-dialog-DpaRLqVS.js";import{u as $}from"./useSEO-BC7slwlt.js";import{b as V}from"./router-6Sp3h7Hu.js";import{L as C,g as ee,U as D,n as se,t as te,u as ae,v as re,w as R,T as le}from"./icons-D1KRm4qg.js";import"./supabase-BI1TbgRl.js";import"./tanstack-C82ICjHp.js";const L=a.forwardRef(({className:l,orientation:s="horizontal",decorative:n=!0,...o},r)=>e.jsx(E,{ref:r,decorative:n,orientation:s,className:F("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",l),...o}));L.displayName=E.displayName;const u={showRatings:"nabd_show_ratings",animations:"nabd_animations"};function _(l,s=!0){try{const n=localStorage.getItem(l);return n===null?s:n!=="false"}catch{return s}}const be=()=>{$({title:"الإعدادات",description:"إدارة إعدادات حسابك وتفضيلاتك الشخصية في نبض",noIndex:!0});const l=V(),{user:s,signOut:n,loading:o}=U(),{toast:r}=q(),[c,x]=a.useState(""),[I,h]=a.useState(!1),[p,f]=a.useState(!1),[T,g]=a.useState(!0),[k,j]=a.useState(!0),d=a.useRef("");a.useEffect(()=>{g(_(u.showRatings,!0)),j(_(u.animations,!0))},[]),a.useEffect(()=>{!o&&!s&&l("/auth",{replace:!0})},[s,o,l]),a.useEffect(()=>{(async()=>{if(!s)return;const i=s.user_metadata?.display_name??s.user_metadata?.full_name??"";i&&!c&&(x(String(i)),d.current=String(i)),h(!0);try{const{data:N,error:v}=await A.from("profiles").select("display_name").eq("id",s.id).maybeSingle();if(v)throw v;const b=(N?.display_name||i||"").toString();x(b),d.current=b}catch{}finally{h(!1)}})()},[s?.id]);const z=a.useMemo(()=>{if(!s)return!1;const t=c.trim();return t.length>0&&t!==d.current.trim()},[c,s]),B=async()=>{if(!s)return;const t=c.trim();if(t.length===0){r({title:"اسم غير صالح",description:"يرجى إدخال اسم عرض صحيح",variant:"destructive"});return}f(!0);try{const{error:i}=await A.from("profiles").update({display_name:t}).eq("id",s.id);if(i)throw i;d.current=t,r({title:"تم الحفظ",description:"تم تحديث معلومات الملف الشخصي"})}catch{r({title:"خطأ",description:"حدث خطأ أثناء حفظ البيانات",variant:"destructive"})}finally{f(!1)}},M=t=>{g(t);try{localStorage.setItem(u.showRatings,String(t))}catch{}r({title:t?"تم تفعيل التقييمات":"تم إخفاء التقييمات",description:t?"ستظهر التقييمات في البطاقات":"تم إخفاء التقييمات من البطاقات"})},O=t=>{j(t);try{localStorage.setItem(u.animations,String(t))}catch{}r({title:t?"تم تفعيل الحركات":"تم إيقاف الحركات",description:t?"ستظهر الحركات في الواجهة":"تم إيقاف حركات الواجهة"})},P=async()=>{await n(),r({title:"تم تسجيل الخروج",description:"نراك قريباً!"}),l("/",{replace:!0})};return o||I?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",dir:"rtl",children:e.jsx(C,{className:"h-12 w-12 animate-spin text-neon-purple"})}):s?e.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",dir:"rtl",children:[e.jsx("div",{className:"fixed top-0 left-1/4 w-72 sm:w-96 h-72 sm:h-96 bg-neon-purple/20 rounded-full blur-[120px] -z-10"}),e.jsx("div",{className:"fixed bottom-0 right-1/4 w-72 sm:w-96 h-72 sm:h-96 bg-neon-blue/20 rounded-full blur-[120px] -z-10"}),e.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/50",children:e.jsx("div",{className:"mx-auto w-full max-w-3xl px-4 py-4",children:e.jsxs(m,{onClick:()=>l("/",{replace:!0}),variant:"ghost",className:"gap-2 text-muted-foreground hover:text-foreground",children:[e.jsx(ee,{className:"h-5 w-5"}),"العودة للرئيسية"]})})}),e.jsxs("main",{className:"mx-auto w-full max-w-3xl px-4 py-8 sm:py-12 space-y-8",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-foreground",children:"الإعدادات"}),e.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"h-6 w-6 text-neon-purple"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الملف الشخصي"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"email",className:"text-muted-foreground",children:"البريد الإلكتروني"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(w,{id:"email",type:"email",value:s.email||"",disabled:!0,className:"pr-10 bg-muted/30 border-border/50 text-muted-foreground cursor-not-allowed"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"displayName",children:"اسم العرض"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(w,{id:"displayName",type:"text",inputMode:"text",placeholder:"اسمك الذي يظهر للآخرين",value:c,onChange:t=>x(t.target.value),className:"pr-10 bg-muted/50 border-border/50"})]})]}),e.jsxs(m,{onClick:B,disabled:p||!z,className:"w-full sm:w-auto bg-gradient-to-r from-neon-purple to-neon-blue hover:opacity-90 gap-2",children:[p?e.jsx(C,{className:"h-4 w-4 animate-spin"}):e.jsx(te,{className:"h-4 w-4"}),"حفظ التغييرات"]})]})]}),e.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{className:"h-6 w-6 text-neon-purple"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"تفضيلات العرض"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 py-3",children:[e.jsxs("div",{className:"space-y-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground",children:"عرض التقييمات"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"إظهار تقييمات الأدوات في البطاقات"})]}),e.jsx(S,{checked:T,onCheckedChange:M})]}),e.jsx(L,{className:"bg-border/50"}),e.jsxs("div",{className:"flex items-center justify-between gap-3 py-3",children:[e.jsxs("div",{className:"space-y-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground",children:"الحركات والتأثيرات"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"تفعيل حركات الواجهة والانتقالات"})]}),e.jsx(S,{checked:k,onCheckedChange:O})]})]})]}),e.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"h-6 w-6 text-neon-purple"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الإشعارات"})]}),e.jsx("p",{className:"text-muted-foreground",children:"إشعارات التطبيق غير متوفرة حالياً. سيتم إضافتها في تحديث قادم."})]}),e.jsxs("section",{className:"glass rounded-2xl p-5 sm:p-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"h-6 w-6 text-destructive"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"الحساب"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(m,{onClick:P,variant:"outline",className:"w-full sm:w-auto gap-2 border-border/50",children:[e.jsx(R,{className:"h-4 w-4"}),"تسجيل الخروج"]}),e.jsxs(H,{children:[e.jsx(K,{asChild:!0,children:e.jsxs(m,{variant:"outline",className:"w-full sm:w-auto gap-2 border-destructive/50 text-destructive hover:bg-destructive/10",children:[e.jsx(le,{className:"h-4 w-4"}),"حذف الحساب"]})}),e.jsxs(Y,{dir:"rtl",className:"glass",children:[e.jsxs(G,{children:[e.jsx(J,{children:"هل أنت متأكد من حذف الحساب؟"}),e.jsx(Q,{children:"سيتم حذف حسابك نهائياً مع جميع المراجعات والبيانات المرتبطة به. هذا الإجراء لا يمكن التراجع عنه."})]}),e.jsxs(W,{className:"flex-row-reverse gap-2",children:[e.jsx(X,{className:"mt-0",children:"إلغاء"}),e.jsx(Z,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>{r({title:"غير متوفر حالياً",description:"يرجى التواصل مع الدعم لحذف حسابك",variant:"destructive"})},children:"حذف الحساب"})]})]})]})]})]})]})]}):null};export{be as default};
